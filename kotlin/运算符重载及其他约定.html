<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>运算符重载及其他约定 | 大坚博客</title>
    <meta name="description" content="现在还远远没有达到需要拼智商的地步">
    <link rel="icon" href="/img/favicon.ico">
    
    <link rel="preload" href="/assets/css/styles.bb1fe17d.css" as="style"><link rel="preload" href="/assets/js/app.bb1fe17d.js" as="script"><link rel="preload" href="/assets/js/67.d396f2ec.js" as="script"><link rel="prefetch" href="/assets/css/1.styles.b05fc641.css"><link rel="prefetch" href="/assets/css/2.styles.a2bd3099.css"><link rel="prefetch" href="/assets/js/1.b05fc641.js"><link rel="prefetch" href="/assets/js/10.326ff491.js"><link rel="prefetch" href="/assets/js/11.9241fc7b.js"><link rel="prefetch" href="/assets/js/12.7acf36a5.js"><link rel="prefetch" href="/assets/js/13.ec549dd5.js"><link rel="prefetch" href="/assets/js/14.28942eba.js"><link rel="prefetch" href="/assets/js/15.e903c1ca.js"><link rel="prefetch" href="/assets/js/16.4d7ab5b5.js"><link rel="prefetch" href="/assets/js/17.36afdc36.js"><link rel="prefetch" href="/assets/js/18.cac2535e.js"><link rel="prefetch" href="/assets/js/19.cd2f75e9.js"><link rel="prefetch" href="/assets/js/2.a2bd3099.js"><link rel="prefetch" href="/assets/js/20.bf313935.js"><link rel="prefetch" href="/assets/js/21.31b36d89.js"><link rel="prefetch" href="/assets/js/22.0361f270.js"><link rel="prefetch" href="/assets/js/23.1b3f1574.js"><link rel="prefetch" href="/assets/js/24.4d491f2a.js"><link rel="prefetch" href="/assets/js/25.52f1876f.js"><link rel="prefetch" href="/assets/js/26.e08e41e4.js"><link rel="prefetch" href="/assets/js/27.4bbac78e.js"><link rel="prefetch" href="/assets/js/28.b5bd620c.js"><link rel="prefetch" href="/assets/js/29.84b65be3.js"><link rel="prefetch" href="/assets/js/3.c091e437.js"><link rel="prefetch" href="/assets/js/30.fe84dfad.js"><link rel="prefetch" href="/assets/js/31.166d5bc3.js"><link rel="prefetch" href="/assets/js/32.d65d9239.js"><link rel="prefetch" href="/assets/js/33.583bc596.js"><link rel="prefetch" href="/assets/js/34.6b83f133.js"><link rel="prefetch" href="/assets/js/35.49d1569f.js"><link rel="prefetch" href="/assets/js/36.0446fb7e.js"><link rel="prefetch" href="/assets/js/37.5fbd12a4.js"><link rel="prefetch" href="/assets/js/38.1b808891.js"><link rel="prefetch" href="/assets/js/39.3b1c557a.js"><link rel="prefetch" href="/assets/js/4.fb6903e4.js"><link rel="prefetch" href="/assets/js/40.ac5b164f.js"><link rel="prefetch" href="/assets/js/41.45b078e5.js"><link rel="prefetch" href="/assets/js/42.d40844bf.js"><link rel="prefetch" href="/assets/js/43.9009d6e3.js"><link rel="prefetch" href="/assets/js/44.1e61fc92.js"><link rel="prefetch" href="/assets/js/45.9424e6d8.js"><link rel="prefetch" href="/assets/js/46.efbee1cd.js"><link rel="prefetch" href="/assets/js/47.cee8ae47.js"><link rel="prefetch" href="/assets/js/48.3d5e7cb5.js"><link rel="prefetch" href="/assets/js/49.22238313.js"><link rel="prefetch" href="/assets/js/5.8891e232.js"><link rel="prefetch" href="/assets/js/50.4affbe35.js"><link rel="prefetch" href="/assets/js/51.fdb6ae2c.js"><link rel="prefetch" href="/assets/js/52.30127554.js"><link rel="prefetch" href="/assets/js/53.0dacde79.js"><link rel="prefetch" href="/assets/js/54.e2815542.js"><link rel="prefetch" href="/assets/js/55.83d95da2.js"><link rel="prefetch" href="/assets/js/56.fd6cfa75.js"><link rel="prefetch" href="/assets/js/57.64041257.js"><link rel="prefetch" href="/assets/js/58.feb49a9c.js"><link rel="prefetch" href="/assets/js/59.dc8df387.js"><link rel="prefetch" href="/assets/js/6.d54c1117.js"><link rel="prefetch" href="/assets/js/60.631c04b3.js"><link rel="prefetch" href="/assets/js/61.32aea37e.js"><link rel="prefetch" href="/assets/js/62.5cfec479.js"><link rel="prefetch" href="/assets/js/63.1433dd8f.js"><link rel="prefetch" href="/assets/js/64.ad33ff3d.js"><link rel="prefetch" href="/assets/js/65.701a8222.js"><link rel="prefetch" href="/assets/js/66.24bd90de.js"><link rel="prefetch" href="/assets/js/68.2afd7019.js"><link rel="prefetch" href="/assets/js/69.05781e5f.js"><link rel="prefetch" href="/assets/js/7.1b94b949.js"><link rel="prefetch" href="/assets/js/70.2cf85943.js"><link rel="prefetch" href="/assets/js/71.aab07104.js"><link rel="prefetch" href="/assets/js/72.1533ead8.js"><link rel="prefetch" href="/assets/js/73.4e5dc4da.js"><link rel="prefetch" href="/assets/js/74.e77dfcb1.js"><link rel="prefetch" href="/assets/js/75.e8e4c83e.js"><link rel="prefetch" href="/assets/js/76.ce341a40.js"><link rel="prefetch" href="/assets/js/77.c2342e89.js"><link rel="prefetch" href="/assets/js/78.a56458f9.js"><link rel="prefetch" href="/assets/js/79.6407212c.js"><link rel="prefetch" href="/assets/js/8.f8c818df.js"><link rel="prefetch" href="/assets/js/80.6554cb4c.js"><link rel="prefetch" href="/assets/js/81.84c710c0.js"><link rel="prefetch" href="/assets/js/82.32cdc5bb.js"><link rel="prefetch" href="/assets/js/83.e08a0de0.js"><link rel="prefetch" href="/assets/js/84.59fefb9d.js"><link rel="prefetch" href="/assets/js/85.af63859c.js"><link rel="prefetch" href="/assets/js/86.513e36a1.js"><link rel="prefetch" href="/assets/js/87.c45c0b70.js"><link rel="prefetch" href="/assets/js/88.92b080af.js"><link rel="prefetch" href="/assets/js/89.ad5aec24.js"><link rel="prefetch" href="/assets/js/9.6d13d821.js"><link rel="prefetch" href="/assets/js/90.a5156631.js"><link rel="prefetch" href="/assets/js/91.fac5ac80.js"><link rel="prefetch" href="/assets/js/92.07aa1e42.js"><link rel="prefetch" href="/assets/js/93.c5f9a0d5.js"><link rel="prefetch" href="/assets/js/94.e05d5d7e.js"><link rel="prefetch" href="/assets/js/95.fea62791.js"><link rel="prefetch" href="/assets/js/96.449a8e88.js"><link rel="prefetch" href="/assets/js/97.94f2a5fd.js">
    <link rel="stylesheet" href="/assets/css/1.styles.b05fc641.css"><link rel="stylesheet" href="/assets/css/2.styles.a2bd3099.css"><link rel="stylesheet" href="/assets/css/styles.bb1fe17d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">大坚博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">客户端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/android/Activity生命周期.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/html/CSS的创建与表现.html" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/Spring.html" class="nav-link">Spring</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kotlin/Kotlin语法基础.html" class="nav-link">Kotlin</a></li><li class="dropdown-item"><!----> <a href="/java/Java平台.html" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/c/类型、运算符与表达式.html" class="nav-link">C</a></li><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">Python</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/设计模式基础.html" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/data-structure/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/network-and-security/" class="nav-link">网络与安全</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">系统与工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/mac/Homebrew.html" class="nav-link">Mac</a></li><li class="dropdown-item"><!----> <a href="/gradle/" class="nav-link">Gradle</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">多媒体</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/opencv/搭建OpenCV Android项目.html" class="nav-link">OpenCV</a></li><li class="dropdown-item"><!----> <a href="/ffmpeg/macOS上编译FFmpeg.html" class="nav-link">FFmpeg</a></li></ul></div></div><div class="nav-item"><a href="/about-me/" class="nav-link">关于我</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">客户端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/android/Activity生命周期.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/html/CSS的创建与表现.html" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/Spring.html" class="nav-link">Spring</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kotlin/Kotlin语法基础.html" class="nav-link">Kotlin</a></li><li class="dropdown-item"><!----> <a href="/java/Java平台.html" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/c/类型、运算符与表达式.html" class="nav-link">C</a></li><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">Python</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/设计模式基础.html" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/data-structure/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/network-and-security/" class="nav-link">网络与安全</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">系统与工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/mac/Homebrew.html" class="nav-link">Mac</a></li><li class="dropdown-item"><!----> <a href="/gradle/" class="nav-link">Gradle</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">多媒体</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/opencv/搭建OpenCV Android项目.html" class="nav-link">OpenCV</a></li><li class="dropdown-item"><!----> <a href="/ffmpeg/macOS上编译FFmpeg.html" class="nav-link">FFmpeg</a></li></ul></div></div><div class="nav-item"><a href="/about-me/" class="nav-link">关于我</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/kotlin/Kotlin语法基础.html" class="sidebar-link">Kotlin语法基础</a></li><li><a href="/kotlin/函数的定义与调用.html" class="sidebar-link">函数的定义与调用</a></li><li><a href="/kotlin/类、对象和接口.html" class="sidebar-link">类、对象和接口</a></li><li><a href="/kotlin/Lambda编程.html" class="sidebar-link">Lambda编程</a></li><li><a href="/kotlin/Kotlin的类型系统.html" class="sidebar-link">Kotlin的类型系统</a></li><li><a href="/kotlin/运算符重载及其他约定.html" class="active sidebar-link">运算符重载及其他约定</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/kotlin/运算符重载及其他约定.html#kotlin约定" class="sidebar-link">Kotlin约定</a></li><li class="sidebar-sub-header"><a href="/kotlin/运算符重载及其他约定.html#运算符重载" class="sidebar-link">运算符重载</a></li><li class="sidebar-sub-header"><a href="/kotlin/运算符重载及其他约定.html#重载算术运算符" class="sidebar-link">重载算术运算符</a></li><li class="sidebar-sub-header"><a href="/kotlin/运算符重载及其他约定.html#重载比较运算符" class="sidebar-link">重载比较运算符</a></li><li class="sidebar-sub-header"><a href="/kotlin/运算符重载及其他约定.html#集合与区间的约定" class="sidebar-link">集合与区间的约定</a></li><li class="sidebar-sub-header"><a href="/kotlin/运算符重载及其他约定.html#解构声明和组件函数" class="sidebar-link">解构声明和组件函数</a></li><li class="sidebar-sub-header"><a href="/kotlin/运算符重载及其他约定.html#委托属性" class="sidebar-link">委托属性</a></li></ul></li><li><a href="/kotlin/高阶函数.html" class="sidebar-link">高阶函数</a></li><li><a href="/kotlin/注解.html" class="sidebar-link">注解</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="运算符重载及其他约定"><a href="#运算符重载及其他约定" aria-hidden="true" class="header-anchor">#</a> 运算符重载及其他约定</h1> <p></p><div class="table-of-contents"><ul><li><a href="#kotlin约定">Kotlin约定</a></li><li><a href="#运算符重载">运算符重载</a></li><li><a href="#重载算术运算符">重载算术运算符</a><ul><li><a href="#重载二元算术运算">重载二元算术运算</a></li><li><a href="#重载复合赋值运算符">重载复合赋值运算符</a></li><li><a href="#重载一元运算符">重载一元运算符</a></li></ul></li><li><a href="#重载比较运算符">重载比较运算符</a><ul><li><a href="#等号运算符">等号运算符</a></li><li><a href="#排序运算符">排序运算符</a></li></ul></li><li><a href="#集合与区间的约定">集合与区间的约定</a><ul><li><a href="#下标约定">下标约定</a></li><li><a href="#in约定">in约定</a></li><li><a href="#rangto约定">rangTo约定</a></li><li><a href="#for循环中的iterator约定">for循环中的iterator约定</a></li></ul></li><li><a href="#解构声明和组件函数">解构声明和组件函数</a></li><li><a href="#委托属性">委托属性</a><ul><li><a href="#委托属性的基本操作">委托属性的基本操作</a></li><li><a href="#惰性初始化和-by-lazy">惰性初始化和by lazy()</a></li><li><a href="#委托属性的变换规则">委托属性的变换规则</a></li><li><a href="#map与委托属性">map与委托属性</a></li></ul></li></ul></div><p></p> <h2 id="kotlin约定"><a href="#kotlin约定" aria-hidden="true" class="header-anchor">#</a> Kotlin约定</h2> <p>Java在标准库中有一些与特定的类相关联的语言特性。例如，实现了<code>java.lang.Iterable</code>接口的对象可以在for循环中使用。</p> <p>在Kotlin中，也有类似的约定，但这些功能与特定的函数命名相关，而不是与特定的类型绑定。例如，在类中定义一个名为<code>plus</code>的特殊方法，那么按照约定，就可以在该类的实例上使用<code>+</code>运算符。</p> <h2 id="运算符重载"><a href="#运算符重载" aria-hidden="true" class="header-anchor">#</a> 运算符重载</h2> <p>用于重载运算符的所有函数都需要用<code>operator</code>关键字来标记，用来表示你打算把这个函数作为相应的约定的实现。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">val</span> x<span class="token operator">:</span> Int<span class="token punctuation">,</span> <span class="token keyword">val</span> y<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">plus</span><span class="token punctuation">(</span>other<span class="token operator">:</span> Point<span class="token punctuation">)</span><span class="token operator">:</span> Point <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>运算符的运算会自动转换成对应函数的调用。例如，<code>point1 + point2</code>会自动转换成<code>point1.plus(point2)</code>。</p> <p>除了把这个运算符声明为一个成员函数外，也可以把它定义为一个扩展函数。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">operator</span> <span class="token keyword">fun</span> Point<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span>other<span class="token operator">:</span> Point<span class="token punctuation">)</span><span class="token operator">:</span> Point <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Kotlin限定了你能重载哪些运算符，以及你需要在你的类中定义的对应名字的函数。</p> <p>自定义类型的运算符，基本上和标准数字类型的运算符有着相同的优先级。</p> <p>定义一个运算符时，不要求两个运算符是相同的类型。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">operator</span> <span class="token keyword">fun</span> Point<span class="token punctuation">.</span><span class="token function">times</span><span class="token punctuation">(</span>scale<span class="token operator">:</span> Double<span class="token punctuation">)</span><span class="token operator">:</span> Point <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">*</span> scale<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>xy<span class="token operator">*</span> scale<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Kotlin运算符不会自动支持交换性。例如，<code>point * 1.5</code>是正确的，而<code>1.5 * point</code>是无效的。除非定义一个<code>operator fun Double.plus(p: Point): Point</code>。</p> <p>运算符函数的返回类型可以不同于任一运算数类型。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">operator</span> <span class="token keyword">fun</span> Char<span class="token punctuation">.</span><span class="token function">times</span><span class="token punctuation">(</span>count<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> String <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>和普通函数一样，可以重载operator函数。</p> <h2 id="重载算术运算符"><a href="#重载算术运算符" aria-hidden="true" class="header-anchor">#</a> 重载算术运算符</h2> <h3 id="重载二元算术运算"><a href="#重载二元算术运算" aria-hidden="true" class="header-anchor">#</a> 重载二元算术运算</h3> <p>可重载的二元算术运算符。</p> <table><thead><tr><th>表达式</th> <th>函数名</th></tr></thead> <tbody><tr><td><code>a * b</code></td> <td>times</td></tr> <tr><td><code>a / b</code></td> <td>div</td></tr> <tr><td><code>a % b</code></td> <td>mod</td></tr> <tr><td><code>a + b</code></td> <td>plus</td></tr> <tr><td><code>a - b</code></td> <td>minus</td></tr></tbody></table> <p>Kotlin没有为标准数字类型定义任何位运算符，也不允许你来定义它们。以下为Kotlin提供的用于执行位运算的完整函数列表（只用于Int和Long）：</p> <table><thead><tr><th>表达式</th> <th>含义</th></tr></thead> <tbody><tr><td><code>a shl 2</code></td> <td>带符号左移</td></tr> <tr><td><code>a shr 2</code></td> <td>带符号右移</td></tr> <tr><td><code>a ushr 2</code></td> <td>无符号右移</td></tr> <tr><td><code>a and b</code></td> <td>按位与</td></tr> <tr><td><code>a or b</code></td> <td>按位或</td></tr> <tr><td><code>a xor b</code></td> <td>按位异或</td></tr> <tr><td><code>a inv b</code></td> <td>按位取反</td></tr></tbody></table> <h3 id="重载复合赋值运算符"><a href="#重载复合赋值运算符" aria-hidden="true" class="header-anchor">#</a> 重载复合赋值运算符</h3> <p>Kotlin不止支持<code>+</code>等运算符，也支持<code>+=</code>等复合赋值运算符。</p> <p><code>+=</code>运算符对应的函数名为<code>plusAssign</code>，其他二元算术运算符也有命名相似的对应函数，如<code>minusAssign</code>。</p> <p>注意，当使用<code>+=</code>时，如果同时定义了<code>plus</code>和<code>plusAssign</code>且它们都适用，编译器会报错。但Kotlin标准库支持集合类同时定义这两种函数：
<code>+</code>总是返回一个新的集合。
<code>+=</code>用于可变集合时，始终在一个地方修改原集合。而<code>+=</code>用于只读集合时，会返回一个修改过的副本。</p> <h3 id="重载一元运算符"><a href="#重载一元运算符" aria-hidden="true" class="header-anchor">#</a> 重载一元运算符</h3> <p>可重载的一元运算符。</p> <table><thead><tr><th>表达式</th> <th>函数名</th></tr></thead> <tbody><tr><td><code>+a</code></td> <td>unaryPlus</td></tr> <tr><td><code>-a</code></td> <td>unaryMinus</td></tr> <tr><td><code>!a</code></td> <td>not</td></tr> <tr><td><code>++a</code>或<code>a++</code></td> <td>inc</td></tr> <tr><td><code>--a</code>或<code>a--</code></td> <td>dec</td></tr></tbody></table> <h2 id="重载比较运算符"><a href="#重载比较运算符" aria-hidden="true" class="header-anchor">#</a> 重载比较运算符</h2> <h3 id="等号运算符"><a href="#等号运算符" aria-hidden="true" class="header-anchor">#</a> 等号运算符</h3> <p>使用<code>==</code>和<code>!=</code>运算符会被转换成<code>equals</code>函数的调用，且它们可用于可空运算数。</p> <p>使用<code>a == b</code>相当于执行<code>a?.equals(b) ?: (b == null)</code>。</p> <p>不同于其他约定，因为<code>equals</code>函数是在Any类中定义的，所以你重新定义该函数时要使用<code>override</code>来标记。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">val</span> x<span class="token operator">:</span> Int<span class="token punctuation">,</span> <span class="token keyword">val</span> y<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">equals</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> Any<span class="token operator">?</span><span class="token punctuation">)</span><span class="token operator">:</span> Boolean <span class="token punctuation">{</span>
        <span class="token comment">// ===为恒等运算符，此处用它来优化。另外，此运算符不可被重载</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">!</span><span class="token keyword">is</span> Point<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token keyword">return</span> obj<span class="token punctuation">.</span>x <span class="token operator">==</span> x <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>y <span class="token operator">==</span> y
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>另外，<code>equals</code>不能实现为扩展函数，因为继承自Any类的实现始终优先于扩展函数。</p> <h3 id="排序运算符"><a href="#排序运算符" aria-hidden="true" class="header-anchor">#</a> 排序运算符</h3> <p>Kotlin支持Comparable接口，其<code>compareTo</code>方法可以按约定调用，即比较运算符（&gt;, &lt;, &lt;=, &gt;=）的使用将会转换成<code>compareTo</code>的调用。</p> <p><code>a &gt;= b</code>相当于<code>a.compareTo(b) &gt;= 0</code>。</p> <p>重写<code>compareTo</code>时，可在其中使用Kotlin标准库中的<code>compareValueBy</code>函数来简洁地实现。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> firstName<span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token keyword">val</span> lastName<span class="token operator">:</span> String<span class="token punctuation">)</span><span class="token operator">:</span> Comparable<span class="token operator">&lt;</span>Person<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">compareTo</span><span class="token punctuation">(</span>other<span class="token operator">:</span> Person<span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
        <span class="token comment">// 比较this和other，先比较它们的lastName，后比较它们的firstName</span>
        <span class="token keyword">return</span> <span class="token function">compareValueBy</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> other<span class="token punctuation">,</span> Person<span class="token operator">::</span>lastName<span class="token punctuation">,</span> Person<span class="token operator">::</span>firstName<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>compareValueBy</code>函数接收用来计算比较值的一系列回调，按顺序依次调用回调方法，如果值不同，则返回比较结果；如果相同，则继续调用下一个；如果没有更多回调，则返回0。这些回调可以是lambda或属性等。</p> <h2 id="集合与区间的约定"><a href="#集合与区间的约定" aria-hidden="true" class="header-anchor">#</a> 集合与区间的约定</h2> <h3 id="下标约定"><a href="#下标约定" aria-hidden="true" class="header-anchor">#</a> 下标约定</h3> <p>使用下标运算符读取元素会被转换为<code>get</code>方法的调用，并且写入元素将调用<code>set</code>方法。</p> <pre><code>`x[a]`相当于`x.get(a)`。

`x[a] = b`相当于`x.set(a, b)`。
</code></pre> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">operator</span> <span class="token keyword">fun</span> Point<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Int <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">when</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token number">0</span> <span class="token operator">-&gt;</span> x
        <span class="token number">1</span> <span class="token operator">-&gt;</span> y
        <span class="token keyword">else</span> <span class="token operator">-&gt;</span> <span class="token keyword">throw</span> <span class="token function">IndexOutOfBoundsException</span><span class="token punctuation">(</span><span class="token string">&quot;Invalid coordinate <span class="token interpolation variable">$index</span>&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>键参数的类型可以是任何类型，而不只是Int。</p> <h3 id="in约定"><a href="#in约定" aria-hidden="true" class="header-anchor">#</a> in约定</h3> <p>集合中的in运算符，用于检查某个对象是否属于集合，实质上是调用了集合的<code>contains</code>函数。例如，<code>a in c</code>相当于<code>c.contains(a)</code>。</p> <p>判断a是否在<code>[1, 10)</code>之间，可使用<code>a in 1 until 10</code>（其中<strong>until</strong>为Kotlin标准库中的函数，用于创建一个<strong>开区间</strong>）。</p> <h3 id="rangto约定"><a href="#rangto约定" aria-hidden="true" class="header-anchor">#</a> rangTo约定</h3> <p>可使用<code>..</code>来创建一个<strong>闭区间</strong>，实质上是调用<code>rangTo</code>函数。例如，<code>start..end</code>相当于<code>start.rangTo(end)</code>。</p> <h3 id="for循环中的iterator约定"><a href="#for循环中的iterator约定" aria-hidden="true" class="header-anchor">#</a> for循环中的iterator约定</h3> <p><code>for (a in b) {...}</code>将被转换成<code>b.iterator()</code>，然后重复调用其<code>hasNext()</code>和<code>next()</code>。</p> <h2 id="解构声明和组件函数"><a href="#解构声明和组件函数" aria-hidden="true" class="header-anchor">#</a> 解构声明和组件函数</h2> <p>解构声明允许你展开单个复合值，并使用它来初始化多个单独的变量。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> p <span class="token operator">=</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">=</span> p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>要在解构声明中初始化每个变量，将调用名为<code>componentN</code>的函数，其中N为声明中变量的位置。例如，<code>val (x, y) = p</code>相当于执行如下操作：</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> a <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">component1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> b <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">component2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>编译器会为<code>data class</code>的主构造方法中声明的属性生成一个<code>componentN</code>的函数。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token keyword">val</span> x<span class="token operator">:</span> Int<span class="token punctuation">,</span> <span class="token keyword">val</span> y<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">component1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> x
    <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">component2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> y
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>标准库只允许此语法来访问一个对象的前5个元素。</p> <p>用解构声明来遍历map。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token keyword">in</span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;<span class="token interpolation variable">$key</span> -&gt; <span class="token interpolation variable">$value</span>&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">for</span> <span class="token punctuation">(</span>entry <span class="token keyword">in</span> map<span class="token punctuation">.</span>entries<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> key <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">component1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> value <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">component2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="委托属性"><a href="#委托属性" aria-hidden="true" class="header-anchor">#</a> 委托属性</h2> <h3 id="委托属性的基本操作"><a href="#委托属性的基本操作" aria-hidden="true" class="header-anchor">#</a> 委托属性的基本操作</h3> <p>委托属性的基本语法如下，属性p将它的访问器逻辑委托给了Delegate类的一个实例对象。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> Foo <span class="token punctuation">{</span>
    <span class="token keyword">var</span> p<span class="token operator">:</span> Type <span class="token keyword">by</span> <span class="token function">Delegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>关键字by对它后面的表达式求值来获得属性的委托对象。</p> <p>Delegate类必须具有<code>getValue</code>和<code>setValue</code>方法（后者仅适用于可变属性）。这两个方法可以是成员函数，也可以是扩展函数。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> Delegate <span class="token punctuation">{</span>
    <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
    
    <span class="token keyword">operator</span> <span class="token keyword">fun</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">,</span> value<span class="token operator">:</span> Type<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="惰性初始化和by-lazy"><a href="#惰性初始化和by-lazy" aria-hidden="true" class="header-anchor">#</a> 惰性初始化和<code>by lazy()</code></h3> <p>惰性初始化是一种常见的模式，直到在第一次访问该属性时，才根据需要创建对象的一部分。</p> <p>例如，在首次访问一个人的邮件列表时，才加载他的邮件列表。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">var</span> _emails<span class="token operator">:</span> List<span class="token operator">&lt;</span>Email<span class="token operator">&gt;</span><span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>
    
    <span class="token keyword">val</span> emails<span class="token operator">:</span> List<span class="token operator">&lt;</span>Email<span class="token operator">&gt;</span>
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>_emails <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                _emails <span class="token operator">=</span> <span class="token function">loadEmails</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> _emails<span class="token operator">!!</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>上面的解决方案，代码啰嗦，而且不是线程安全的。可利用Kotlin的<code>lazy</code>函数加上关键字by来创建委托属性。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> emails <span class="token keyword">by</span> lazy <span class="token punctuation">{</span> <span class="token function">loadEmails</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>lazy</code>函数的参数为一个lambda，并返回一个具有<code>getValue</code>方法的对象。之后把这个对象与by关键字一起创建一个委托属性。默认情况下，<code>lazy</code>函数是线程安全的。</p> <h3 id="委托属性的变换规则"><a href="#委托属性的变换规则" aria-hidden="true" class="header-anchor">#</a> 委托属性的变换规则</h3> <p>假设有一个具有委托属性的类。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> C <span class="token punctuation">{</span>
    <span class="token keyword">var</span> prop<span class="token operator">:</span> Type <span class="token keyword">by</span> <span class="token function">MyDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>关键字by后接的表达式求值后得到的对象会被保存在一个名为<code>&lt;delegate&gt;</code>的隐藏属性中。编译器也将用一个KProperty类型的对象来代表这个属性，它被称为<code>&lt;property&gt;</code>。</p> <p>编译器生成的代码如下：</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> C <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> <span class="token operator">&lt;</span>delegate<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">MyDelegate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">var</span> prop<span class="token operator">:</span> Type
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>delegate<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span><span class="token punctuation">)</span>
        <span class="token keyword">set</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Type<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>property<span class="token operator">&gt;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>val x = c.prop</code>相当于<code>val x = &lt;delegate&gt;.getValue(c, &lt;property&gt;)</code>。</p> <p><code>c.prop = x</code>相当于<code>&lt;property&gt;.setValue(c, &lt;property&gt;, x)</code>。</p> <h3 id="map与委托属性"><a href="#map与委托属性" aria-hidden="true" class="header-anchor">#</a> map与委托属性</h3> <p>Kotlin标准库在标准Map和MutableMap接口上定义了getValue和setValue扩展函数，于是，委托属性可以使用任意map来作为属性委托，来灵活地处理具有可变属性集的对象。</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">class</span> Person <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">val</span> _attributes <span class="token operator">=</span> hashMapOf<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">fun</span> <span class="token function">setAttribute</span><span class="token punctuation">(</span>attrName<span class="token operator">:</span> String<span class="token punctuation">,</span> value<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        _attributes<span class="token punctuation">[</span>attrName<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token punctuation">}</span>
    
    <span class="token keyword">val</span> name<span class="token operator">:</span> String <span class="token keyword">by</span> _attributes
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>委托属性的名称将自动用作在map中的键，属性值作为map中的值。</p> <ul><li><p><code>person.name</code>相当于<code>_attributes[&quot;name&quot;]</code>。</p></li> <li><p><code>person.name = &quot;daking&quot;</code>相当于<code>_attributes[&quot;name&quot;] = &quot;daking&quot;</code>。</p></li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/67.d396f2ec.js" defer></script><script src="/assets/js/app.bb1fe17d.js" defer></script>
  </body>
</html>
