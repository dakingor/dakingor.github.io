(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{236:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"spring-boot配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot配置","aria-hidden":"true"}},[t._v("#")]),t._v(" Spring Boot配置")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#自动配置"}},[t._v("自动配置")]),s("ul",[s("li",[s("a",{attrs:{href:"#自动配置的决策"}},[t._v("自动配置的决策")])]),s("li",[s("a",{attrs:{href:"#自定义条件类"}},[t._v("自定义条件类")])]),s("li",[s("a",{attrs:{href:"#条件化注解"}},[t._v("条件化注解")])])])]),s("li",[s("a",{attrs:{href:"#自定义配置"}},[t._v("自定义配置")]),s("ul",[s("li",[s("a",{attrs:{href:"#显式配置"}},[t._v("显式配置")])]),s("li",[s("a",{attrs:{href:"#属性配置"}},[t._v("属性配置")])]),s("li",[s("a",{attrs:{href:"#bean的外置属性"}},[t._v("Bean的外置属性")])]),s("li",[s("a",{attrs:{href:"#profile配置"}},[t._v("Profile配置")])])])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"自动配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 自动配置")]),t._v(" "),s("p",[t._v("Spring Boot的自动配置是在应用程序启动时进行的。它决定Spring配置应该用哪个，不该用哪个。")]),t._v(" "),s("p",[t._v("向应用程序加入Spring Boot时，引入了一个名为"),s("code",[t._v("spring-boot-autoconfigure")]),t._v("的jar文件。此文件包含了许多配置类，每个配置类都在应用程序的Classpath里，都有机会为应用程序的配置添砖加瓦。")]),t._v(" "),s("p",[t._v("这些配置类利用了Spring4.0新增的"),s("strong",[t._v("条件化配置")]),t._v("。条件化配置允许配置存在于应用程序中，但在满足某些特定条件之前都忽略这个配置。")]),t._v(" "),s("h3",{attrs:{id:"自动配置的决策"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动配置的决策","aria-hidden":"true"}},[t._v("#")]),t._v(" 自动配置的决策")]),t._v(" "),s("p",[t._v("结合之前创建的ReadingList项目，自动配置会做出以下配置决策：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("因为Classpath里有H2，所以会创建一个嵌入式的H2数据库Bean。")])]),t._v(" "),s("li",[s("p",[t._v("因为Classpath里有Hibernate（Spring Data JPA传递引入），所以会自动配置与Hibernate相关的Bean。")])]),t._v(" "),s("li",[s("p",[t._v("因为Classpath里有Spring Data JPA，所以会自动配置为根据仓库的接口创建仓库实现。")])]),t._v(" "),s("li",[s("p",[t._v("因为Classpath有Thymeleaf，所以会将Thymeleaf配置为Spring MVC的视图。它对应的视图解析器会解析相对于Classpath根目录的"),s("code",[t._v("/templates")]),t._v("目录中的模板。")])]),t._v(" "),s("li",[s("p",[t._v("因为Classpath里有Spring MVC，所以会配置DispatcherServlet并启用Spring MVC。")])]),t._v(" "),s("li",[s("p",[t._v("因为这个一个Spring MVC Web应用程序，所以会注册一个资源处理器，把相对于Classpath根目录的"),s("code",[t._v("/static")]),t._v("目录中的静态资源提取出来。")])]),t._v(" "),s("li",[s("p",[t._v("因为Classpath里有Tomcat，所以会启动一个嵌入式的Tomcat容器，默认监听8080端口。")])])]),t._v(" "),s("h3",{attrs:{id:"自定义条件类"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义条件类","aria-hidden":"true"}},[t._v("#")]),t._v(" 自定义条件类")]),t._v(" "),s("p",[t._v("在Spring中实现"),s("code",[t._v("Condition")]),t._v("接口，重写其"),s("code",[t._v("matches()")]),t._v("便可编写自定义条件类。比如，编写"),s("code",[t._v("JdbcTemplateCondition")]),t._v("在Classpath里存在"),s("code",[t._v("JdbcTemplate")]),t._v("类时才会生效。")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("JdbcTemplateCondition")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Condition")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("matches")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ConditionContext context"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    AnnotatedTypeMetadata metadata"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            context"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("getClassLoader")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("loadClass")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                "),s("span",{attrs:{class:"token string"}},[t._v('"org.springframework.jdbc.core.JdbcTemplate"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("false")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br")])]),s("p",[t._v("在声明Bean时，可以使用这个自定义条件类。只有当该条件类生效时，才会创建这个Bean。")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Conditional")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("JdbcTemplateCondition"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" MyService "),s("span",{attrs:{class:"token function"}},[t._v("myService")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"条件化注解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#条件化注解","aria-hidden":"true"}},[t._v("#")]),t._v(" 条件化注解")]),t._v(" "),s("p",[t._v("Spring Boot提供了如下条件化注解。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("条件化注解")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("配置生效条件")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnBean")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("配置了某个特定Bean")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnMissingBean")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("没有配置特定的Bean")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnClass")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Classpath里有指定的类")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnMissingClass")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Classpath里缺少指定的类")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnExpression")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("给定的Spring Expression Language表达式计算结果为true")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnJava")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Java的版本匹配特定值或一个范围值")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnJndi")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("参数中给定的JNDI位置必须存在一个，如果没有给参数，则要有JNDI InitialContext")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnProperty")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("指定的配置属性要有一个明确的值")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnResource")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("Classpath有指定的资源")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnWebApplication")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("这个一个Web应用程序")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[t._v("@ConditionOnNotWebApplication")]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("这不是一个Web应用程序")])])])]),t._v(" "),s("h2",{attrs:{id:"自定义配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 自定义配置")]),t._v(" "),s("p",[t._v("影响自动配置的方式有：一，使用显式配置进行覆盖；二，使用属性进行精细化配置。")]),t._v(" "),s("h3",{attrs:{id:"显式配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#显式配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 显式配置")]),t._v(" "),s("p",[t._v("大多数情况下，自动配置的Bean就能满足需要，但有些情况下，还是需要覆盖某些自动配置来更好地实现需求。比如，安全特性的自动配置。")]),t._v(" "),s("p",[t._v("想要覆盖Spring Boot的自动配置，首先编写一个"),s("strong",[t._v("显式的配置")]),t._v("，然后"),s("strong",[t._v("降低自动配置的优先级")]),t._v("。")]),t._v(" "),s("p",[t._v("Spring Boot Security默认的自动配置为"),s("code",[t._v("SpringBootWebSecurityConfiguration")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@EnableConfigurationProperties")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@ConditionalOnClass")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" EnableWebSecurity"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AuthenticationEntryPoint"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@ConditionalOnMissingBean")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("WebSecurityConfiguration"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@ConditionalOnWebApplication")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@EnableWebSecurity")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("SpringBootWebSecurityConfiguration")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[t._v("因为"),s("code",[t._v("SpringBootWebSecurityConfiguration")]),t._v("有"),s("code",[t._v("@ConditionalOnMissingBean(WebSecurityConfiguration.class)")]),t._v("，所以当我们定义一个显式的"),s("code",[t._v("WebSecurityConfiguration")]),t._v("配置实现类时，这个自动配置就会失效。")]),t._v(" "),s("p",[t._v("注意，"),s("code",[t._v("WebSecurityConfigurerAdapter")]),t._v("是"),s("code",[t._v("WebSecurityConfiguration")]),t._v("接口的实现类。")]),t._v(" "),s("div",{staticClass:"language-kotlin line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-kotlin"}},[s("code",[s("span",{attrs:{class:"token annotation builtin"}},[t._v("@Configuration")]),t._v("\n"),s("span",{attrs:{class:"token annotation builtin"}},[t._v("@EnableWebSecurity")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" SecurityConfig "),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("WebSecurityConfigurerAdapter")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("fun")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("configure")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" HttpSecurity"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("override")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("fun")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("configure")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("auth"),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" AuthenticationManagerBuilder"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("h3",{attrs:{id:"属性配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#属性配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 属性配置")]),t._v(" "),s("p",[t._v("Spring Boot自动配置的Bean提供了数百个用于微调的属性。当你需要调整这些属性值时，只要在环境变量、Java系统属性、JNDI（Java Naming and Directory Interface）、命令行参数或属性文件中进行指定。")]),t._v(" "),s("h4",{attrs:{id:"属性配置示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#属性配置示例","aria-hidden":"true"}},[t._v("#")]),t._v(" 属性配置示例")]),t._v(" "),s("p",[t._v("将"),s("code",[t._v("spring.main.show-banner")]),t._v("属性设置为false来禁用ascii-art Banner。")]),t._v(" "),s("p",[t._v("可以在运行应用程序的命令行参数里指定参数"),s("code",[t._v("--spring.main.show-banner=false")]),t._v("。")]),t._v(" "),s("p",[t._v("可以创建一个名为"),s("code",[t._v("application.properties")]),t._v("的文件，包含内容"),s("code",[t._v("spring.main.show-banner=false")]),t._v("。")]),t._v(" "),s("p",[t._v("可以创建一个名为"),s("code",[t._v("application.yml")]),t._v("的YAML文件，内容如下：")]),t._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("spring:\n\tmain:\n\t\tshow-banner: false\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("也可以添加一个环境变量，比如"),s("code",[t._v("export spring_main_show_banner=false")]),t._v("。")]),t._v(" "),s("h4",{attrs:{id:"属性源"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#属性源","aria-hidden":"true"}},[t._v("#")]),t._v(" 属性源")]),t._v(" "),s("p",[t._v("Spring Boot能从多种属性源获得属性，包含如下几处：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("命令行参数")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("java:comp/env")]),t._v("里的JNDI属性")])]),t._v(" "),s("li",[s("p",[t._v("JVM系统属性")])]),t._v(" "),s("li",[s("p",[t._v("操作系统环境变量")])]),t._v(" "),s("li",[s("p",[t._v("随机生成的带"),s("code",[t._v("random.*")]),t._v("前缀的属性")])]),t._v(" "),s("li",[s("p",[t._v("应用程序以外的"),s("code",[t._v("application.properties")]),t._v("或"),s("code",[t._v("application.yml")]),t._v("文件")])]),t._v(" "),s("li",[s("p",[t._v("打包在应用程序内的"),s("code",[t._v("application.properties")]),t._v("或"),s("code",[t._v("application.yml")]),t._v("文件")])]),t._v(" "),s("li",[s("p",[t._v("通过"),s("code",[t._v("@PropertySource")]),t._v("标注的属性源")])]),t._v(" "),s("li",[s("p",[t._v("默认属性​")])])]),t._v(" "),s("p",[t._v("上面的列表是按照优先级排序。即"),s("code",[t._v("/config")]),t._v("子目录中的"),s("code",[t._v("application.properties")]),t._v("会覆盖应用程序Classpath里的"),s("code",[t._v("application.properties")]),t._v("中的相同属性。")]),t._v(" "),s("p",[t._v("同一优先级位置的"),s("code",[t._v("application.yml")]),t._v("的属性会覆盖"),s("code",[t._v("application.properties")]),t._v("的相同属性。")]),t._v(" "),s("p",[s("code",[t._v("application.properties")]),t._v("和"),s("code",[t._v("application.yml")]),t._v("文件能放在以下四个位置（按照优先级排序）：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("外置，在相对于应用程序运行目录的/config子目录里")])]),t._v(" "),s("li",[s("p",[t._v("外置，在应用程序运行的目录里。")])]),t._v(" "),s("li",[s("p",[t._v("内置，在config包内。")])]),t._v(" "),s("li",[s("p",[t._v("内置，在Classpath根目录。")])])]),t._v(" "),s("h3",{attrs:{id:"bean的外置属性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bean的外置属性","aria-hidden":"true"}},[t._v("#")]),t._v(" Bean的外置属性")]),t._v(" "),s("p",[t._v("在属性文件（"),s("code",[t._v("application.properties")]),t._v("或"),s("code",[t._v("application.yml")]),t._v("）中定义自定义属性。比如"),s("code",[t._v("custom.associateId=daking")]),t._v("。")]),t._v(" "),s("p",[t._v("在代码中使用"),s("code",[t._v('@ConfigurationProperties("custom")')]),t._v("来引入以"),s("code",[t._v("custom")]),t._v("为前缀的"),s("strong",[t._v("外置属性")]),t._v("。")]),t._v(" "),s("p",[t._v("注意，要向Spring配置类添加"),s("code",[t._v("@EnableConfigurationProperties")]),t._v("后，"),s("code",[t._v("@ConfigurationProperties")]),t._v("才会生效。而Spring Boot自动配置已经为我们添加了。")]),t._v(" "),s("p",[t._v("一般是创建一个单独的Bean来专门收集这些外置属性。")]),t._v(" "),s("div",{staticClass:"language-kotlin line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-kotlin"}},[s("code",[s("span",{attrs:{class:"token annotation builtin"}},[t._v("@Component")]),t._v("\n"),s("span",{attrs:{class:"token annotation builtin"}},[t._v("@ConfigurationProperties")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"custom"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" CustomProperties "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),s("span",{attrs:{class:"token keyword"}},[t._v("lateinit")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" associateId"),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" String\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("h3",{attrs:{id:"profile配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#profile配置","aria-hidden":"true"}},[t._v("#")]),t._v(" Profile配置")]),t._v(" "),s("p",[t._v("Spring 3.1开始支持基于Profile的配置。它是一种条件化配置，基于运行时激活的Profile，会使用或忽略不同的Bean或配置类。")]),t._v(" "),s("p",[t._v("为特定的环境进行特定的Profile配置，可实现开发、测试、生产等不同环境的隔离。比如为生产环境制定的production Profile。")]),t._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Profile")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"production"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@EnableWebSecurity")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("SecurityConfig")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("WebSecurityConfigurerAdapter")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("设置"),s("code",[t._v("spring.profiles.active=production")]),t._v("才能激活上面的production Profile。")]),t._v(" "),s("h4",{attrs:{id:"application-properties与profile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#application-properties与profile","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("code",[t._v("application.properties")]),t._v("与Profile")]),t._v(" "),s("p",[t._v("用"),s("code",[t._v("application.properties")]),t._v("来指定满足各种环境下的通用的属性配置。")]),t._v(" "),s("p",[t._v("遵循"),s("code",[t._v("application-{profile}.properties")]),t._v("命名格式来创建特定环境的属性文件。比如，创建一个仅用于生产环境的"),s("code",[t._v("application-production.properties")]),t._v("文件，在这个文件中指定属性配置。")]),t._v(" "),s("h4",{attrs:{id:"application-yml与profile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#application-yml与profile","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("code",[t._v("application.yml")]),t._v("与Profile")]),t._v(" "),s("p",[s("code",[t._v("application.yml")]),t._v("的用法与上面的"),s("code",[t._v("application.properties")]),t._v("类似，但可以把所有的Profile配置都放在同一个"),s("code",[t._v("application.yml")]),t._v("文件中。")]),t._v(" "),s("p",[t._v("每段Profile配置用"),s("code",[t._v("spring.profiles")]),t._v("属性来指定Profile名称，若未指定则表示对全部Profile生效。不同的Profile配置之间用"),s("code",[t._v("---")]),t._v("作为分隔符。")]),t._v(" "),s("p",[t._v("注意，特定Profile配置会覆盖通用配置的相同属性。")]),t._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("logging:\n    level:\n        root: INFO\n\n---\n\nspring:\n    profiles: development\n\nlogging:\n    level:\n        root: DEBUG\n\n---\n\nspring:\n    profiles: production\n\nlogging:\n    path: /tmp/\n    file: BookWorm.log\n    level:\n        root: WARN\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br")])])])}],!1,null,null,null);e.options.__file="Spring Boot配置.md";a.default=e.exports}}]);