(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{160:function(t,n,a){"use strict";a.r(n);var s=a(0),e=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"intent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intent","aria-hidden":"true"}},[t._v("#")]),t._v(" Intent")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#intent作用"}},[t._v("Intent作用")]),a("ul",[a("li",[a("a",{attrs:{href:"#启动activity"}},[t._v("启动Activity")])]),a("li",[a("a",{attrs:{href:"#启动服务"}},[t._v("启动服务")])]),a("li",[a("a",{attrs:{href:"#发送广播"}},[t._v("发送广播")])])])]),a("li",[a("a",{attrs:{href:"#intent类型"}},[t._v("Intent类型")]),a("ul",[a("li",[a("a",{attrs:{href:"#显式intent"}},[t._v("显式Intent")])]),a("li",[a("a",{attrs:{href:"#隐式intent"}},[t._v("隐式Intent")])])])]),a("li",[a("a",{attrs:{href:"#intent的组成"}},[t._v("Intent的组成")]),a("ul",[a("li",[a("a",{attrs:{href:"#componentname"}},[t._v("ComponentName")])]),a("li",[a("a",{attrs:{href:"#action"}},[t._v("Action")])]),a("li",[a("a",{attrs:{href:"#data"}},[t._v("Data")])]),a("li",[a("a",{attrs:{href:"#category"}},[t._v("Category")])]),a("li",[a("a",{attrs:{href:"#extras"}},[t._v("Extras")])]),a("li",[a("a",{attrs:{href:"#flags"}},[t._v("Flags")])])])]),a("li",[a("a",{attrs:{href:"#构建intent"}},[t._v("构建Intent")]),a("ul",[a("li",[a("a",{attrs:{href:"#显式intent示例"}},[t._v("显式Intent示例")])]),a("li",[a("a",{attrs:{href:"#隐式intent示例"}},[t._v("隐式Intent示例")])]),a("li",[a("a",{attrs:{href:"#应用选择器"}},[t._v("应用选择器")])]),a("li",[a("a",{attrs:{href:"#service与隐式intent"}},[t._v("Service与隐式Intent")])])])]),a("li",[a("a",{attrs:{href:"#intentfilter"}},[t._v("IntentFilter")])]),a("li",[a("a",{attrs:{href:"#intent解析"}},[t._v("Intent解析")]),a("ul",[a("li",[a("a",{attrs:{href:"#action测试"}},[t._v("Action测试")])]),a("li",[a("a",{attrs:{href:"#category测试"}},[t._v("Category测试")])]),a("li",[a("a",{attrs:{href:"#data测试"}},[t._v("Data测试")])]),a("li",[a("a",{attrs:{href:"#intent匹配"}},[t._v("Intent匹配")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"intent作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intent作用","aria-hidden":"true"}},[t._v("#")]),t._v(" Intent作用")]),t._v(" "),a("p",[t._v("Intent是一个消息传递对象，可使用它来请求操作（同一应用或其他应用均可）。")]),t._v(" "),a("h3",{attrs:{id:"启动activity"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动activity","aria-hidden":"true"}},[t._v("#")]),t._v(" 启动Activity")]),t._v(" "),a("p",[t._v("Intent对象描述了要启动的Activity，并携带了任何必要的数据。")]),t._v(" "),a("p",[t._v("将Intent对象传递给"),a("code",[t._v("Context#startActivity()")]),t._v("便可启动Activity实例。")]),t._v(" "),a("p",[t._v("如果希望在Activity完成后收到结果，就调用"),a("code",[t._v("Context#startActivityForResult()")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"启动服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动服务","aria-hidden":"true"}},[t._v("#")]),t._v(" 启动服务")]),t._v(" "),a("p",[t._v("Intent对象描述了要启动的Service，并携带了任何必要的数据。")]),t._v(" "),a("p",[t._v("将Intent对象传递给"),a("code",[t._v("Context#startService()")]),t._v("便可启动Service实例。")]),t._v(" "),a("p",[t._v("将Intent对象传递给"),a("code",[t._v("Context#bindService()")]),t._v("使组件绑定到指定Service上。")]),t._v(" "),a("h3",{attrs:{id:"发送广播"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发送广播","aria-hidden":"true"}},[t._v("#")]),t._v(" 发送广播")]),t._v(" "),a("p",[t._v("调用Context类的"),a("code",[t._v("sendBroadcast()")]),t._v("、"),a("code",[t._v("sendOrderedBroadcast()")]),t._v("和"),a("code",[t._v("sendStickyBroadcast()")]),t._v("等方法，传入Intent对象，便可发送广播。")]),t._v(" "),a("h2",{attrs:{id:"intent类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intent类型","aria-hidden":"true"}},[t._v("#")]),t._v(" Intent类型")]),t._v(" "),a("h3",{attrs:{id:"显式intent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#显式intent","aria-hidden":"true"}},[t._v("#")]),t._v(" 显式Intent")]),t._v(" "),a("p",[t._v("显式Intent：按名称（完全限定类名）指定要启动的组件。")]),t._v(" "),a("p",[t._v("使用显式Intent启动组件时，系统会立即启动Intent对象中指定的应用组件。")]),t._v(" "),a("h3",{attrs:{id:"隐式intent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#隐式intent","aria-hidden":"true"}},[t._v("#")]),t._v(" 隐式Intent")]),t._v(" "),a("p",[t._v("隐式Intent：不会指定特定的组件，而是声明要执行的常规操作，从而允许其他应用中的组件来处理它。")]),t._v(" "),a("p",[t._v("使用隐式Intent启动组件时，系统会将Intent的内容与设备上所有应用的Manifest中声明的IntentFilter进行比较，从而找到要启动的相应组件。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("如果Intent与IntentFilter匹配，则系统将启动该组件，并向其传递Intent对象。")])]),t._v(" "),a("li",[a("p",[t._v("如果多个IntentFilter兼容，则系统会显示一个对话框，由用户决定最终要启动的应用组件。")])])]),t._v(" "),a("h2",{attrs:{id:"intent的组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intent的组成","aria-hidden":"true"}},[t._v("#")]),t._v(" Intent的组成")]),t._v(" "),a("p",[t._v("Intent是由ComponentName、Action、Data、Category、Extras和Flags组成。")]),t._v(" "),a("p",[t._v("ComponentName、Action、Data和Category表示Intent的既定特征，Android通过这些属性来解析应当启动哪个应用组件，而Extras和Flags是不影响应用组件的解析。")]),t._v(" "),a("h3",{attrs:{id:"componentname"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#componentname","aria-hidden":"true"}},[t._v("#")]),t._v(" ComponentName")]),t._v(" "),a("p",[t._v("ComponentName为要启动的组件名称。")]),t._v(" "),a("p",[t._v("这是可选项，但也是构建显式Intent的一项重要信息。如果没有组件名，则Intent是隐式的。")]),t._v(" "),a("p",[t._v("可通过以下API来设置Intent的组件名。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Intent的构造函数"),a("code",[t._v("Intent(Context packageContext, Class<?> cls)")]),t._v("。")])]),t._v(" "),a("li",[a("p",[t._v("Intent类的"),a("code",[t._v("Intent setClass(Context context, Class<?> cls)")]),t._v("。")])]),t._v(" "),a("li",[a("p",[t._v("Intent类的"),a("code",[t._v("Intent setComponentName(ComponentName component)")]),t._v("。ComponentName包含要启动的组件的包名、类等信息。")])])]),t._v(" "),a("h3",{attrs:{id:"action"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#action","aria-hidden":"true"}},[t._v("#")]),t._v(" Action")]),t._v(" "),a("p",[t._v("Action为指定要执行的通用操作的字符串。")]),t._v(" "),a("p",[t._v("可通过以下API来设置Intent的操作。")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Intent的构造函数"),a("code",[t._v("Intent (String action)")]),t._v("。")])]),t._v(" "),a("li",[a("p",[t._v("Intent类的"),a("code",[t._v("Intent setAction(String action)")]),t._v("。")])])]),t._v(" "),a("h3",{attrs:{id:"data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data","aria-hidden":"true"}},[t._v("#")]),t._v(" Data")]),t._v(" "),a("p",[t._v("Data为待操作数据（Uri对象）、数据的MIME类型。")]),t._v(" "),a("p",[t._v("调用"),a("code",[t._v("Intent#setData(Uri data)")]),t._v("设置Uri数据，调用"),a("code",[t._v("Intent#setType(String type)")]),t._v("设置MIME类型，调用"),a("code",[t._v("Intent#setDataAndType(Uri data, String type)")]),t._v("同时设置二者。")]),t._v(" "),a("p",[t._v("注意，"),a("code",[t._v("setData()")]),t._v("和"),a("code",[t._v("setType()")]),t._v("会相互抵消彼此的值，应该始终使用"),a("code",[t._v("setDataAndType()")]),t._v("来同时设置它们。")]),t._v(" "),a("h3",{attrs:{id:"category"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#category","aria-hidden":"true"}},[t._v("#")]),t._v(" Category")]),t._v(" "),a("p",[t._v("Category表示要启动的组件类型的附加信息的字符串。")]),t._v(" "),a("p",[t._v("调用"),a("code",[t._v("Intent#addCategory(String category)")]),t._v("来添加类别。")]),t._v(" "),a("h3",{attrs:{id:"extras"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#extras","aria-hidden":"true"}},[t._v("#")]),t._v(" Extras")]),t._v(" "),a("p",[t._v("Extras携带完成请求操作所需的附加信息的键值对。")]),t._v(" "),a("p",[t._v("使用各种"),a("code",[t._v("Intent#putExtra()")]),t._v("方法传入键和值来添加extra数据。")]),t._v(" "),a("p",[t._v("也可使用"),a("code",[t._v("Intent#putExtras()")]),t._v("将Bundle传入Intent中。")]),t._v(" "),a("h3",{attrs:{id:"flags"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flags","aria-hidden":"true"}},[t._v("#")]),t._v(" Flags")]),t._v(" "),a("p",[t._v("Flags充当Intent元数据的标志。")]),t._v(" "),a("p",[t._v("可使用Flags来指示系统如何启动Activity（例如，Activity 应属于哪个任务），以及启动之后如何处理（例如，它是否属于最近的Activity列表）。")]),t._v(" "),a("p",[t._v("调用"),a("code",[t._v("Intent#addFlags()")]),t._v("或"),a("code",[t._v("Intent#setFlags()")]),t._v("来设置Intent的标志。")]),t._v(" "),a("h2",{attrs:{id:"构建intent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建intent","aria-hidden":"true"}},[t._v("#")]),t._v(" 构建Intent")]),t._v(" "),a("h3",{attrs:{id:"显式intent示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#显式intent示例","aria-hidden":"true"}},[t._v("#")]),t._v(" 显式Intent示例")]),t._v(" "),a("p",[t._v("要创建显式Intent，需要明确地指定ComponentName，其他属性均为可选项。")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("Intent intent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Intent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MainActivity"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token keyword"}},[t._v("class")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncontext"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("startActivity")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h3",{attrs:{id:"隐式intent示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#隐式intent示例","aria-hidden":"true"}},[t._v("#")]),t._v(" 隐式Intent示例")]),t._v(" "),a("p",[t._v("Intent不需要明确指定被启动对象的组件信息，而指定其Action、Category、Data。")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("Intent sendIntent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Intent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nsendIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setAction")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Intent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ACTION_SEND"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nsendIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("putExtra")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Intent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("EXTRA_TEXT"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" textMessage"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nsendIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setType")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"text/plain"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token function"}},[t._v("startActivity")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sendIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[t._v("如果当前设备上没有任何应用的Activity组件能处理这个"),a("code",[t._v("startActivity()")]),t._v("中的隐式Intent，此调用将会失败，且应用会崩溃。可以使用"),a("code",[t._v("Intent#resolveActivity()")]),t._v("来判断是否有对应的Activity组件能处理该隐式Intent，再安全地调用"),a("code",[t._v("startActivity()")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sendIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("resolveActivity")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token function"}},[t._v("getPackageManager")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("!=")]),t._v(" null"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token function"}},[t._v("startActivity")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sendIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"应用选择器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用选择器","aria-hidden":"true"}},[t._v("#")]),t._v(" 应用选择器")]),t._v(" "),a("p",[t._v("如果有多个应用响应隐式Intent，系统会弹出应用选择器，让用户可以选择要使用的应用，并可以将其设置为该操作的默认选项，之后不再显示选择器。")]),t._v(" "),a("p",[t._v("可使用Intent类的"),a("code",[t._v("static Intent createChooser (Intent target, CharSequence title)")]),t._v("来包装隐式Intent，使其每次都强制弹出应用选择器。")]),t._v(" "),a("h3",{attrs:{id:"service与隐式intent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service与隐式intent","aria-hidden":"true"}},[t._v("#")]),t._v(" Service与隐式Intent")]),t._v(" "),a("p",[t._v("使用隐式Intent启动服务存在安全隐患：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("开发者无法确定哪些服务将响应Intent。")])]),t._v(" "),a("li",[a("p",[t._v("用户无法看到哪些服务被启动。")])])]),t._v(" "),a("p",[t._v("从Android 5.0（API 21）开始，Service必须要采用显式Intent来启动，否则会报错"),a("code",[t._v("Service Intent must be explicit")]),t._v("。")]),t._v(" "),a("p",[t._v("Google官方推荐使用"),a("strong",[t._v("为Intent对象设置PackageName和Action")]),t._v("的方式来启动Service。")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v("Intent intent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Intent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nintent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setAction")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"<Action>"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nintent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setPackage")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"<PackageName>"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncontext"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("startService")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("intent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("p",[t._v("也可以"),a("strong",[t._v("将隐式Intent转换成显式Intent")]),t._v("来启动Service。")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("static")]),t._v(" Intent "),a("span",{attrs:{class:"token function"}},[t._v("createExplicitFromImplicitIntent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Context context"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Intent implicitIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// Retrieve all services that can match the given intent")]),t._v("\n    PackageManager pm "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" context"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("getPackageManager")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    List"),a("span",{attrs:{class:"token generics function"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ResolveInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" resolveInfo "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" pm"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("queryIntentServices")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("implicitIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n    "),a("span",{attrs:{class:"token comment"}},[t._v("// Make sure only one match was found")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolveInfo "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" null "),a("span",{attrs:{class:"token operator"}},[t._v("||")]),t._v(" resolveInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("size")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" null"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n \n    "),a("span",{attrs:{class:"token comment"}},[t._v("// Get component info and create ComponentName")]),t._v("\n    ResolveInfo serviceInfo "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" resolveInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    String packageName "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" serviceInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("serviceInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("packageName"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    String className "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" serviceInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("serviceInfo"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ComponentName component "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("ComponentName")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("packageName"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" className"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n    "),a("span",{attrs:{class:"token comment"}},[t._v("// Create a new intent. Use the old one for extras and such reuse")]),t._v("\n    Intent explicitIntent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Intent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("implicitIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token comment"}},[t._v("// Set the component to be explicit")]),t._v("\n    explicitIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setComponent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("component"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" explicitIntent"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br")])]),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("final")]),t._v(" Intent intent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Intent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nintent"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("setAction")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"<Action>"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("final")]),t._v(" Intent eintent "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{attrs:{class:"token class-name"}},[t._v("Intent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token function"}},[t._v("createExplicitFromImplicitIntent")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("context"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" intent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ncontext"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("startService")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eintent"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h2",{attrs:{id:"intentfilter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intentfilter","aria-hidden":"true"}},[t._v("#")]),t._v(" IntentFilter")]),t._v(" "),a("p",[t._v("应用中的组件要接收隐式Intent，必须在Manifest中使用"),a("code",[t._v("<intent-filter>")]),t._v("来为该组件声明一个或多个IntentFilter。")]),t._v(" "),a("p",[t._v("每个IntentFilter根据Intent的"),a("strong",[t._v("Action、Category和Data")]),t._v("指定应用组件所能接受的Intent。在"),a("code",[t._v("<intent-filter>")]),t._v("中，通过以下三个元素中的一个或多个指定要接受的Intent。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("<action>")]),t._v("：声明接受的Intent操作。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("<category>")]),t._v("：声明接受的Intent类别。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("<data>")]),t._v("：使用一个或多个指定数据URI各个方面（scheme、host、port、path等）和MIME类型的属性，声明接受的数据类型。")])])]),t._v(" "),a("p",[t._v("显式Intent始终会传递给目标组件，而隐式Intent仅当匹配Intent过滤器成功后，方可传递给目标组件。")]),t._v(" "),a("p",[t._v("IntentFilter的特点：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("一个应用组件可有多个IntentFilter。")])]),t._v(" "),a("li",[a("p",[t._v("一个IntentFilter可含有0、一个或多个action。")])]),t._v(" "),a("li",[a("p",[t._v("一个IntentFilter可含有0、一个或多个data。")])]),t._v(" "),a("li",[a("p",[t._v("一个IntentFilter可含有0、一个或多个category。")])])]),t._v(" "),a("p",[t._v("入口Activity的IntentFilter配置如下：")]),t._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("intent-filter")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("action")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[a("span",{attrs:{class:"token namespace"}},[t._v("android:")]),t._v("name")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("android.intent.action.MAIN"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("category")]),t._v(" "),a("span",{attrs:{class:"token attr-name"}},[a("span",{attrs:{class:"token namespace"}},[t._v("android:")]),t._v("name")]),a("span",{attrs:{class:"token attr-value"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{attrs:{class:"token punctuation"}},[t._v('"')]),t._v("android.intent.category.LAUNCHER"),a("span",{attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token tag"}},[a("span",{attrs:{class:"token punctuation"}},[t._v("</")]),t._v("intent-filter")]),a("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h2",{attrs:{id:"intent解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intent解析","aria-hidden":"true"}},[t._v("#")]),t._v(" Intent解析")]),t._v(" "),a("p",[t._v("系统根据Action、Category和Data这三个方面来将Intent和IntentFilter进行比较，从而选择匹配的应用组件。")]),t._v(" "),a("p",[t._v("一个Intent需要"),a("strong",[t._v("同时匹配一个IntentFilter的action、category和data")]),t._v("才算匹配成功。")]),t._v(" "),a("p",[t._v("即使一个应用组件有多个IntentFilter，但一个Intent"),a("strong",[t._v("只要成功匹配任意一个IntentFilter")]),t._v("即可。")]),t._v(" "),a("h3",{attrs:{id:"action测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#action测试","aria-hidden":"true"}},[t._v("#")]),t._v(" Action测试")]),t._v(" "),a("p",[t._v("只要Intent中的Action与IntentFilter中"),a("strong",[t._v("任一Action相同")]),t._v("就可通过测试。")]),t._v(" "),a("p",[t._v("因为IntentFilter可以包含0个action，所以Intent找不到任何匹配项，于是所有Intent都无法匹配这个Filter。")]),t._v(" "),a("h3",{attrs:{id:"category测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#category测试","aria-hidden":"true"}},[t._v("#")]),t._v(" Category测试")]),t._v(" "),a("p",[t._v("Intent中的每个category都要在IntentFilter中找到对应的category，才会通过测试。")]),t._v(" "),a("p",[t._v("系统会自动将"),a("code",[t._v("CATEGORY_DEFAULT")]),t._v("类别应用于传递给"),a("code",[t._v("startActivity()")]),t._v("和"),a("code",[t._v("startActivityForResult()")]),t._v("的所有隐式Intent。因此，如需要Activity接收隐式 Intent，则必须将"),a("code",[t._v("android.intent.category.DEFAULT")]),t._v("的类别包括在其IntentFilter中。")]),t._v(" "),a("h3",{attrs:{id:"data测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data测试","aria-hidden":"true"}},[t._v("#")]),t._v(" Data测试")]),t._v(" "),a("p",[a("code",[t._v("<data>")]),t._v("可指定URI数据和MIME类型。")]),t._v(" "),a("p",[t._v("URI数据包含scheme、host、port和path等属性，一个完整的URI为"),a("code",[t._v("<scheme>://<host>:<port>/<path>")]),t._v("。每个属性都是可选的，但存在线性依赖关系：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("如果未指定scheme，则会忽略host。")])]),t._v(" "),a("li",[a("p",[t._v("如果未指定host，则会忽略port。")])]),t._v(" "),a("li",[a("p",[t._v("如果未指定scheme和host，则会忽略path。")])])]),t._v(" "),a("p",[t._v("Intent中的URI仅与IntentFilter中包含的部分URI进行比较，如：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("如果IntentFilter仅指定scheme，则具有相同scheme的所有URI都与它匹配。")])]),t._v(" "),a("li",[a("p",[t._v("如果IntentFilter指定scheme、host和port，但未指定path，则具有相同scheme、host和port的所有URI都与它匹配。")])]),t._v(" "),a("li",[a("p",[t._v("如果IntentFilter指定scheme、host、port和path，则具有相同scheme、host、port和path的所有URI才与它匹配。")])])]),t._v(" "),a("p",[t._v("Data测试会将Intent中的URI和MIME类型与IntentFilter中的URI和MIME类型进行比较。规则如下：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("仅当IntentFilter未指定任何URI或MIME类型时，不含URI和MIME类型的Intent才会通过测试。")])]),t._v(" "),a("li",[a("p",[t._v("对于包含URI但不含MIME类型（既未显式声明，也无法通过URI推断得出）的Intent，仅当其URI与IntentFilter的URI匹配、且IntentFilter同样未指定MIME类型时，才会通过测试。")])]),t._v(" "),a("li",[a("p",[t._v("仅当IntentFilter列出相同的MIME类型且未指定URI格式时，包含MIME类型、但不含URI的 Intent才会通过测试。")])]),t._v(" "),a("li",[a("p",[t._v("如果IntentFilter只声明MIME类型，则假定组件支持"),a("code",[t._v("content:")]),t._v("和"),a("code",[t._v("file:")]),t._v("的URI。")])])]),t._v(" "),a("h3",{attrs:{id:"intent匹配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#intent匹配","aria-hidden":"true"}},[t._v("#")]),t._v(" Intent匹配")]),t._v(" "),a("p",[t._v("可利用Intent类中的"),a("code",[t._v("resolve*")]),t._v("方法查询满足条件的Activity组件。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("ComponentName resolveActivity (PackageManager pm)")]),t._v("。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("ActivityInfo resolveActivityInfo (PackageManager pm, int flags)")]),t._v("。")])])]),t._v(" "),a("p",[t._v("可利用PackageManager类中的"),a("code",[t._v("query*")]),t._v("方法查询满足某隐式Intent的目标组件。其中，参数it表示要匹配的Intent，参数flags表示要匹配的标志位（建议传入"),a("code",[t._v("PackageManager.MATCH_DEFAULT_ONLY")]),t._v("来匹配category为"),a("code",[t._v("android.intent.category.DEFAULT")]),t._v("的目标组件）。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("List<ResolveInfo> queryIntentActivities(Intent it, int flags)")]),t._v("匹配Activity。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("List<ResolveInfo> queryIntentServices(Intent it, int flags)")]),t._v("匹配Service。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("List<ResolveInfo> queryBroadcastReceivers(Intent it, int flags)")]),t._v("匹配BroadcastReceiver。")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("List<ResolveInfo> queryIntentContentProviders(Intent it, int flags)")]),t._v("匹配ContentProvider。")])])])])}],!1,null,null,null);e.options.__file="Intent.md";n.default=e.exports}}]);