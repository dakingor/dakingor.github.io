(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{151:function(t,a,n){"use strict";n.r(a);var s=n(0),e=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"activity生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#activity生命周期","aria-hidden":"true"}},[t._v("#")]),t._v(" Activity生命周期")]),t._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#activity生命周期的回调方法"}},[t._v("Activity生命周期的回调方法")]),n("ul",[n("li",[n("a",{attrs:{href:"#oncreate"}},[t._v("onCreate()")])]),n("li",[n("a",{attrs:{href:"#onrestart"}},[t._v("onRestart()")])]),n("li",[n("a",{attrs:{href:"#onstart"}},[t._v("onStart()")])]),n("li",[n("a",{attrs:{href:"#onresume"}},[t._v("onResume()")])]),n("li",[n("a",{attrs:{href:"#onpause"}},[t._v("onPause()")])]),n("li",[n("a",{attrs:{href:"#onstop"}},[t._v("onStop()")])]),n("li",[n("a",{attrs:{href:"#ondestroy"}},[t._v("onDestroy()")])])])]),n("li",[n("a",{attrs:{href:"#activity生命周期的切换过程"}},[t._v("Activity生命周期的切换过程")])]),n("li",[n("a",{attrs:{href:"#activity生命周期的各阶段"}},[t._v("Activity生命周期的各阶段")]),n("ul",[n("li",[n("a",{attrs:{href:"#完整生命周期"}},[t._v("完整生命周期")])]),n("li",[n("a",{attrs:{href:"#可见生命周期"}},[t._v("可见生命周期")])]),n("li",[n("a",{attrs:{href:"#前台生命周期"}},[t._v("前台生命周期")])])])]),n("li",[n("a",{attrs:{href:"#异常的生命周期分析"}},[t._v("异常的生命周期分析")]),n("ul",[n("li",[n("a",{attrs:{href:"#activity的优先级"}},[t._v("Activity的优先级")])]),n("li",[n("a",{attrs:{href:"#onsaveinstancestate-和-onrestoreinstancestate"}},[t._v("onSaveInstanceState()和onRestoreInstanceState()")])]),n("li",[n("a",{attrs:{href:"#onconfigurationchanged"}},[t._v("onConfigurationChanged()")])]),n("li",[n("a",{attrs:{href:"#利用fragment来保存和恢复"}},[t._v("利用Fragment来保存和恢复")])]),n("li",[n("a",{attrs:{href:"#onretainnonconfigurationinstance"}},[t._v("onRetainNonConfigurationInstance()")])])])])])]),n("p"),t._v(" "),n("h2",{attrs:{id:"activity生命周期的回调方法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#activity生命周期的回调方法","aria-hidden":"true"}},[t._v("#")]),t._v(" Activity生命周期的回调方法")]),t._v(" "),n("h3",{attrs:{id:"oncreate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#oncreate","aria-hidden":"true"}},[t._v("#")]),t._v(" onCreate()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("何时：Activity正在被创建。")])]),t._v(" "),n("li",[n("p",[t._v("作用：进行初始化工作，如setContentView(界面资源)、初始化Activity所需数据。")])]),t._v(" "),n("li",[n("p",[t._v("注意：此方法的传参Bundle为该Activity上次被异常情况销毁时保存的状态信息。")])])]),t._v(" "),n("h3",{attrs:{id:"onrestart"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onrestart","aria-hidden":"true"}},[t._v("#")]),t._v(" onRestart()")]),t._v(" "),n("ul",[n("li",[t._v("何时：Activity正在重新启动。当前Activity从不可见重新变为可见。")])]),t._v(" "),n("h3",{attrs:{id:"onstart"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onstart","aria-hidden":"true"}},[t._v("#")]),t._v(" onStart()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("何时：Activity正在被启动。")])]),t._v(" "),n("li",[n("p",[t._v("注意：此时"),n("strong",[t._v("Activity已可见，但还不在前台")]),t._v("，还无法和用户交互。")])])]),t._v(" "),n("h3",{attrs:{id:"onresume"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onresume","aria-hidden":"true"}},[t._v("#")]),t._v(" onResume()")]),t._v(" "),n("ul",[n("li",[t._v("何时："),n("strong",[t._v("Activity已在前台")]),t._v("。")])]),t._v(" "),n("h3",{attrs:{id:"onpause"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onpause","aria-hidden":"true"}},[t._v("#")]),t._v(" onPause()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("何时：Activity正在停止。当前"),n("strong",[t._v("Activity已不在前台")]),t._v("。")])]),t._v(" "),n("li",[n("p",[t._v("作用：你需要保存更改到持久数据、停止一些动画、停止一些耗时CPU操作等。")])]),t._v(" "),n("li",[n("p",[t._v("注意：此方法不可做耗时操作。"),n("code",[t._v("onPause()")]),t._v("必须先执行完，新Activity的"),n("code",[t._v("onResume()")]),t._v("才会执行。")])])]),t._v(" "),n("h3",{attrs:{id:"onstop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onstop","aria-hidden":"true"}},[t._v("#")]),t._v(" onStop()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("何时：Activity即将停止。当前"),n("strong",[t._v("Activity已不可见")]),t._v("。")])]),t._v(" "),n("li",[n("p",[t._v("作用：在此方法中，可做一些稍微重量级的回收工作，如：取消网络连接、注销广播接收器等。")])])]),t._v(" "),n("h3",{attrs:{id:"ondestroy"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ondestroy","aria-hidden":"true"}},[t._v("#")]),t._v(" onDestroy()")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("何时：Activity即将被销毁。")])]),t._v(" "),n("li",[n("p",[t._v("作用：做回收工作和最终的资源释放。")])])]),t._v(" "),n("h2",{attrs:{id:"activity生命周期的切换过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#activity生命周期的切换过程","aria-hidden":"true"}},[t._v("#")]),t._v(" Activity生命周期的切换过程")]),t._v(" "),n("p",[n("img",{attrs:{src:"/15245341319670/15245343656178.jpg",alt:"Activity生命周期的切换过程"}})]),t._v(" "),n("ul",[n("li",[n("p",[t._v("第一次启动，回调如下："),n("code",[t._v("onCreate -> onStart -> onResume")]),t._v("。")])]),t._v(" "),n("li",[n("p",[t._v("当用户打开新的Activity时，回调如下："),n("code",[t._v("A onPause -> B onCreate -> B onStart -> B onResume -> A onStop")]),t._v("。注意，若新的Activity采用了透明主题，那么当前Activity不会回调"),n("code",[t._v("onStop")]),t._v("。")])]),t._v(" "),n("li",[n("p",[t._v("当用户再次回到原Activity时，回调如下："),n("code",[t._v("onRestart -> onStart -> onResume")]),t._v("。")])]),t._v(" "),n("li",[n("p",[t._v("当前单一Activity在前台，用户按back键时，回调如下："),n("code",[t._v("onPause -> onStop -> onDestroy")]),t._v("。")])]),t._v(" "),n("li",[n("p",[t._v("当前单一Activity在前台，用户按Home键/锁屏时，回调如下："),n("code",[t._v("onPause -> onStop")]),t._v("。")])])]),t._v(" "),n("h2",{attrs:{id:"activity生命周期的各阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#activity生命周期的各阶段","aria-hidden":"true"}},[t._v("#")]),t._v(" Activity生命周期的各阶段")]),t._v(" "),n("h3",{attrs:{id:"完整生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#完整生命周期","aria-hidden":"true"}},[t._v("#")]),t._v(" 完整生命周期")]),t._v(" "),n("p",[t._v("Activity在"),n("code",[t._v("onCreate()")]),t._v("和"),n("code",[t._v("onDestroy()")]),t._v("之间所经历的。")]),t._v(" "),n("p",[t._v("在"),n("code",[t._v("onCreate()")]),t._v("中完成各初始化操作；在"),n("code",[t._v("onDestroy()")]),t._v("中释放资源。")]),t._v(" "),n("h3",{attrs:{id:"可见生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#可见生命周期","aria-hidden":"true"}},[t._v("#")]),t._v(" 可见生命周期")]),t._v(" "),n("p",[t._v("Activity在"),n("code",[t._v("onStart()")]),t._v("和"),n("code",[t._v("onStop()")]),t._v("之间所经历的。")]),t._v(" "),n("p",[t._v("活动对于用户是可见的，但仍无法与用户进行交互。")]),t._v(" "),n("h3",{attrs:{id:"前台生命周期"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前台生命周期","aria-hidden":"true"}},[t._v("#")]),t._v(" 前台生命周期")]),t._v(" "),n("p",[t._v("Activity在"),n("code",[t._v("onResume()")]),t._v("和"),n("code",[t._v("onPause()")]),t._v("之间所经历的。")]),t._v(" "),n("p",[t._v("活动可见，且可交互。")]),t._v(" "),n("h2",{attrs:{id:"异常的生命周期分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#异常的生命周期分析","aria-hidden":"true"}},[t._v("#")]),t._v(" 异常的生命周期分析")]),t._v(" "),n("p",[t._v("当资源相关的系统配置发生改变导致Activity被杀死并重建。")]),t._v(" "),n("p",[t._v("当内存不足时，系统会杀死低优先级的Activity。")]),t._v(" "),n("h3",{attrs:{id:"activity的优先级"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#activity的优先级","aria-hidden":"true"}},[t._v("#")]),t._v(" Activity的优先级")]),t._v(" "),n("p",[t._v("Activity按照优先级从高到低，可分为如下三种：")]),t._v(" "),n("ol",[n("li",[n("p",[n("strong",[t._v("前台Activity")]),t._v(" —— 正在和用户交互，优先级最高。")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("可见但不在前台的Activity")]),t._v(" —— 比如Activity中有弹窗，导致其可见但不在前台，无法与用户交互。")])]),t._v(" "),n("li",[n("p",[n("strong",[t._v("后台Activity")]),t._v(" —— 已被停止的Activity，比如执行"),n("code",[t._v("onStop")]),t._v("，优先级最低。")])])]),t._v(" "),n("p",[t._v("当系统内存不足时，会按照Activity优先级从低到高去杀死目标Activity所在的进程。")]),t._v(" "),n("p",[t._v("若一个进程没有四大组件在执行，那么这个进程将很快被系统杀死。")]),t._v(" "),n("h3",{attrs:{id:"onsaveinstancestate-和onrestoreinstancestate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onsaveinstancestate-和onrestoreinstancestate","aria-hidden":"true"}},[t._v("#")]),t._v(" "),n("code",[t._v("onSaveInstanceState()")]),t._v("和"),n("code",[t._v("onRestoreInstanceState()")])]),t._v(" "),n("p",[t._v("当出现异常情况时，首先，Activity会被销毁，系统会回调其"),n("code",[t._v("onPause() -> onStop() -> onDestroy()")]),t._v("，同时也会调用"),n("code",[t._v("onSaveInstanceState()")]),t._v("来保存当前Activity的状态。")]),t._v(" "),n("p",[t._v("注意，"),n("strong",[n("code",[t._v("onSaveInstanceState()")]),t._v("在"),n("code",[t._v("onStop()")]),t._v("之前调用")]),t._v("，它与"),n("code",[t._v("onPause()")]),t._v("没有既定的时序关系。")]),t._v(" "),n("p",[t._v("接着，如果Activity能被重新创建，系统会回调其"),n("code",[t._v("onCreate() -> onStart() -> onResume()")]),t._v("，同时会将上次异常终止时保存的状态传递"),n("code",[t._v("onRestoreInstanceState()")]),t._v("和"),n("code",[t._v("onCreate()")]),t._v("。")]),t._v(" "),n("p",[t._v("注意，"),n("code",[t._v("onRestoreInstanceState()")]),t._v("会"),n("strong",[t._v("在"),n("code",[t._v("onStart()")]),t._v("之后被调用")]),t._v("。")]),t._v(" "),n("p",[t._v("在Activity被销毁前，系统会默认为我们保存该Activity的视图结构，并且在Activity重建后恢复这些视图结构，比如：文本框中用户输入的数据、列表滚动的位置等。")]),t._v(" "),n("p",[t._v("其实，和Activity一样，每个View都有"),n("code",[t._v("onSaveInstanceState()")]),t._v("和"),n("code",[t._v("onRestoreInstanceState()")]),t._v("，而且官方View组件都有默认的实现。")]),t._v(" "),n("p",[t._v("保存View层次结构的工作流程是：")]),t._v(" "),n("ol",[n("li",[n("p",[t._v("Activity调动"),n("code",[t._v("onSaveInstanceState()")]),t._v("去保存数据。")])]),t._v(" "),n("li",[n("p",[t._v("然后Activity会委托Window去保存数据。")])]),t._v(" "),n("li",[n("p",[t._v("Window再委托它的顶级ViewGroup去保存数据。")])]),t._v(" "),n("li",[n("p",[t._v("顶级ViewGroup再一一调用它的子视图View的"),n("code",[t._v("onSaveInstanceState(0")]),t._v("来保存数据。")])])]),t._v(" "),n("p",[t._v("而恢复View层次结构的工作流程与上面类似，也是上层委托下层，不同的是调用"),n("code",[t._v("onRestoreInstanceState()")]),t._v("。")]),t._v(" "),n("h3",{attrs:{id:"onconfigurationchanged"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onconfigurationchanged","aria-hidden":"true"}},[t._v("#")]),t._v(" "),n("code",[t._v("onConfigurationChanged()")])]),t._v(" "),n("p",[t._v("当系统配置发生改变后，Activity会被销毁且重新创建。")]),t._v(" "),n("p",[t._v("系统配置中有很多内容，若当某项内容发生改变后，我们不想系统重新创建Activity，可给"),n("code",[t._v("<Activity>")]),t._v("中的"),n("code",[t._v("configChanges")]),t._v("属性赋予对应值。之后"),n("strong",[t._v("当指定的系统配置项发生改变时，Activity不会被重新创建，系统仅仅回调其"),n("code",[t._v("void onConfigurationChanged(Configuration newConfig);")])])]),t._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[t._v('android:configChanges="orientation|keyboardHidden|locale"\n')])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br")])]),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"left"}},[t._v("系统配置项")]),t._v(" "),n("th",{staticStyle:{"text-align":"left"}},[t._v("含义")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("mcc")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("SIM卡唯一标识IMSI中的国家代码发生改变，三位数字。"),n("br"),t._v("中国为460。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("mnc")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("SIM卡唯一标识IMSI中的运营商代码发生改变，两位数字。"),n("br"),t._v("中国移动TD系统为00，联通为01，电信为03。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[n("strong",[t._v("locale")])]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("设备的本地位置发生改变。"),n("br"),t._v("如切换了系统语言。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("touchscreen")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("触摸屏发生改变。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("keyboard")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("键盘类型发生改变。"),n("br"),t._v("比如用户使用了外接键盘。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[n("strong",[t._v("keyboardHidden")])]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("键盘的可访问性发生改变。"),n("br"),t._v("比如用户调出了键盘。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("navigation")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("系统导航方式发生改变。"),n("br"),t._v("如采用了轨迹球导航。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("screenLayout")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("屏幕布局发生改变。"),n("br"),t._v("如用户激活了另一个显示设备。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("fontScale")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("系统字体缩放比例发生改变。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("uiMode")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("用户界面模式发生改变。"),n("br"),t._v("如开启了夜间模式(API8添加)。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[n("strong",[t._v("orientation")])]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("屏幕方向发生改变。"),n("br"),t._v("如旋转手机屏幕。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("screenSize")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("屏幕的尺寸信息发生改变。"),n("br"),t._v("若"),n("code",[t._v("minSdkVersion")]),t._v("和"),n("code",[t._v("targetSdkVersion")]),t._v("都低于13时，此项不生效。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("smallestScreenSize")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("设备的实际物理屏幕尺寸发生改变，这个项和屏幕的方向没有关系。"),n("br"),t._v("比如用户切换到外部的显示设备上。"),n("br"),t._v("若"),n("code",[t._v("minSdkVersion")]),t._v("和"),n("code",[t._v("targetSdkVersion")]),t._v("都低于13时，此项不生效。")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("layoutDirection")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("布局方向发生改变。(API17添加)")])])])]),t._v(" "),n("h3",{attrs:{id:"利用fragment来保存和恢复"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#利用fragment来保存和恢复","aria-hidden":"true"}},[t._v("#")]),t._v(" 利用Fragment来保存和恢复")]),t._v(" "),n("p",[n("code",[t._v("onSaveInstanceState(Bundle)")]),t._v("中的Bundle类型变量，只能保存少量的数据，对于Bitmap等大数据则无能为力。此时可利用Fragment来进行大量数据的保存与恢复。")]),t._v(" "),n("p",[t._v("用于数据保护与数据的Fragment需要满足以下条件：")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("此Fragment必须是空视图，即不实现"),n("code",[t._v("onCreateView()")]),t._v("或该方法返回null。")])]),t._v(" "),n("li",[n("p",[t._v("重写此Fragment的"),n("code",[t._v("onCreate()")]),t._v("，并在其内部调用"),n("code",[t._v("Fragment#setRetainInstance(true);")]),t._v("。")])]),t._v(" "),n("li",[n("p",[t._v("声明需要保存的数据对象，并提供getter和setter。")])])]),t._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("RetainedFragment")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Fragment")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// 需要保存的数据")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" Bitmap data"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n      \n    "),n("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("  \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("onCreate")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Bundle savedInstanceState"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n        "),n("span",{attrs:{class:"token keyword"}},[t._v("super")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("onCreate")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("savedInstanceState"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n        "),n("span",{attrs:{class:"token function"}},[t._v("setRetainInstance")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token boolean"}},[t._v("true")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n  \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("setData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Bitmap data"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n        "),n("span",{attrs:{class:"token keyword"}},[t._v("this")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n  \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" Bitmap "),n("span",{attrs:{class:"token function"}},[t._v("getData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" data"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br")])]),n("ul",[n("li",[t._v("将RetainedFragment应用到Activity上。")])]),t._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("FragmentRetainDataActivity")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("Activity")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("final")]),t._v(" String DATA_FRAGMENT_TAG "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v('"data"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" RetainedFragment dataFragment"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" Bitmap mBitmap"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),n("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("  \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("onCreate")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Bundle savedInstanceState"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n        "),n("span",{attrs:{class:"token keyword"}},[t._v("super")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("onCreate")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("savedInstanceState"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n        "),n("span",{attrs:{class:"token function"}},[t._v("setContentView")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("R"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("layout"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("activity_xxx"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n    \n        "),n("span",{attrs:{class:"token comment"}},[t._v("// 寻找上次创建过的RetainedFragment。若无，则创建并添加。")]),t._v("\n        FragmentManager fm "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("getFragmentManager")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n        dataFragment "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RetainedFragment"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" fm"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("findFragmentByTag")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DATA_FRAGMENT_TAG"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n        "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataFragment "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" null"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n            dataFragment "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("RetainedFragment")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n            fm"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("beginTransaction")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("add")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataFragment"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" DATA_FRAGMENT_TAG"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("commit")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("  \n         \n        "),n("span",{attrs:{class:"token function"}},[t._v("initData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),n("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("  \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("onDestroy")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("super")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("onDestroy")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("// 保存数据")]),t._v("\n        dataFragment"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("setData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mBitmap"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("initData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        mBitmap "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("collectMyLoadedData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mBitmap "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" null"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{attrs:{class:"token comment"}},[t._v("// 数据未被创建过")]),t._v("\n        "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" Bitmap "),n("span",{attrs:{class:"token function"}},[t._v("collectMyLoadedData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" dataFragment"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("getData")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br")])]),n("h3",{attrs:{id:"onretainnonconfigurationinstance"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#onretainnonconfigurationinstance","aria-hidden":"true"}},[t._v("#")]),t._v(" "),n("code",[t._v("onRetainNonConfigurationInstance()")])]),t._v(" "),n("p",[t._v("由于设备配置改变导致Activity重建，在Activity销毁前，系统会调用它的"),n("code",[t._v("onRetainNonConfigurationInstance()")]),t._v("，可以保存任何类型的对象。")]),t._v(" "),n("p",[t._v("在Activity重建之后，可以调用"),n("code",[t._v("getLastNonConfigurationInstance()")]),t._v("来获取之前保存的对象。")]),t._v(" "),n("p",[t._v("FragmentActivity在"),n("code",[t._v("onCreate(Bundle savedInstanceState)")]),t._v("中调用"),n("code",[t._v("getLastNonConfigurationInstance()")]),t._v("获取之前保存的信息，如"),n("code",[t._v("ViewModelStore")]),t._v("对象。")]),t._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("onCreate")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Nullable")]),t._v(" Bundle savedInstanceState"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    NonConfigurationInstances nc "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("NonConfigurationInstances"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("getLastNonConfigurationInstance")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nc "),n("span",{attrs:{class:"token operator"}},[t._v("!=")]),t._v(" null"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        mViewModelStore "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" nc"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("viewModelStore"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])]),n("p",[t._v("FragmentActivity重写父类Activity的"),n("code",[t._v("onRetainNonConfigurationInstance()")]),t._v("以在销毁（因设备配置改变导致）前保存自定义数据、"),n("code",[t._v("ViewModelStore")]),t._v("对象和各Fragment等信息。")]),t._v(" "),n("p",[t._v("而且，FragmentActivity把"),n("code",[t._v("onRetainNonConfigurationInstance()")]),t._v("声明为final，并提供一个新定义的"),n("code",[t._v("onRetainCustomNonConfigurationInstance()")]),t._v("给子类重写来保存自定义数据。")]),t._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("final")]),t._v(" Object "),n("span",{attrs:{class:"token function"}},[t._v("onRetainNonConfigurationInstance")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mStopped"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token function"}},[t._v("doReallyStop")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token boolean"}},[t._v("true")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    Object custom "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("onRetainCustomNonConfigurationInstance")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    FragmentManagerNonConfig fragments "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mFragments"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("retainNestedNonConfig")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fragments "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" null "),n("span",{attrs:{class:"token operator"}},[t._v("&&")]),t._v(" mViewModelStore "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" null "),n("span",{attrs:{class:"token operator"}},[t._v("&&")]),t._v(" custom "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" null"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" null"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    NonConfigurationInstances nci "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("NonConfigurationInstances")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    nci"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("custom "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" custom"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    nci"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("viewModelStore "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mViewModelStore"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    nci"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fragments "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" fragments"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nci"),n("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br")])])])}],!1,null,null,null);e.options.__file="Activity生命周期.md";a.default=e.exports}}]);