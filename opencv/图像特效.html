<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>图像特效 | 大坚博客</title>
    <meta name="description" content="现在还远远没有达到需要拼智商的地步">
    <link rel="icon" href="/img/favicon.ico">
    
    <link rel="preload" href="/assets/css/styles.bb1fe17d.css" as="style"><link rel="preload" href="/assets/js/app.bb1fe17d.js" as="script"><link rel="preload" href="/assets/js/80.6554cb4c.js" as="script"><link rel="prefetch" href="/assets/css/1.styles.b05fc641.css"><link rel="prefetch" href="/assets/css/2.styles.a2bd3099.css"><link rel="prefetch" href="/assets/js/1.b05fc641.js"><link rel="prefetch" href="/assets/js/10.326ff491.js"><link rel="prefetch" href="/assets/js/11.9241fc7b.js"><link rel="prefetch" href="/assets/js/12.7acf36a5.js"><link rel="prefetch" href="/assets/js/13.ec549dd5.js"><link rel="prefetch" href="/assets/js/14.28942eba.js"><link rel="prefetch" href="/assets/js/15.e903c1ca.js"><link rel="prefetch" href="/assets/js/16.4d7ab5b5.js"><link rel="prefetch" href="/assets/js/17.36afdc36.js"><link rel="prefetch" href="/assets/js/18.cac2535e.js"><link rel="prefetch" href="/assets/js/19.cd2f75e9.js"><link rel="prefetch" href="/assets/js/2.a2bd3099.js"><link rel="prefetch" href="/assets/js/20.bf313935.js"><link rel="prefetch" href="/assets/js/21.31b36d89.js"><link rel="prefetch" href="/assets/js/22.0361f270.js"><link rel="prefetch" href="/assets/js/23.1b3f1574.js"><link rel="prefetch" href="/assets/js/24.4d491f2a.js"><link rel="prefetch" href="/assets/js/25.52f1876f.js"><link rel="prefetch" href="/assets/js/26.e08e41e4.js"><link rel="prefetch" href="/assets/js/27.4bbac78e.js"><link rel="prefetch" href="/assets/js/28.b5bd620c.js"><link rel="prefetch" href="/assets/js/29.84b65be3.js"><link rel="prefetch" href="/assets/js/3.c091e437.js"><link rel="prefetch" href="/assets/js/30.fe84dfad.js"><link rel="prefetch" href="/assets/js/31.166d5bc3.js"><link rel="prefetch" href="/assets/js/32.d65d9239.js"><link rel="prefetch" href="/assets/js/33.583bc596.js"><link rel="prefetch" href="/assets/js/34.6b83f133.js"><link rel="prefetch" href="/assets/js/35.49d1569f.js"><link rel="prefetch" href="/assets/js/36.0446fb7e.js"><link rel="prefetch" href="/assets/js/37.5fbd12a4.js"><link rel="prefetch" href="/assets/js/38.1b808891.js"><link rel="prefetch" href="/assets/js/39.3b1c557a.js"><link rel="prefetch" href="/assets/js/4.fb6903e4.js"><link rel="prefetch" href="/assets/js/40.ac5b164f.js"><link rel="prefetch" href="/assets/js/41.45b078e5.js"><link rel="prefetch" href="/assets/js/42.d40844bf.js"><link rel="prefetch" href="/assets/js/43.9009d6e3.js"><link rel="prefetch" href="/assets/js/44.1e61fc92.js"><link rel="prefetch" href="/assets/js/45.9424e6d8.js"><link rel="prefetch" href="/assets/js/46.efbee1cd.js"><link rel="prefetch" href="/assets/js/47.cee8ae47.js"><link rel="prefetch" href="/assets/js/48.3d5e7cb5.js"><link rel="prefetch" href="/assets/js/49.22238313.js"><link rel="prefetch" href="/assets/js/5.8891e232.js"><link rel="prefetch" href="/assets/js/50.4affbe35.js"><link rel="prefetch" href="/assets/js/51.fdb6ae2c.js"><link rel="prefetch" href="/assets/js/52.30127554.js"><link rel="prefetch" href="/assets/js/53.0dacde79.js"><link rel="prefetch" href="/assets/js/54.e2815542.js"><link rel="prefetch" href="/assets/js/55.83d95da2.js"><link rel="prefetch" href="/assets/js/56.fd6cfa75.js"><link rel="prefetch" href="/assets/js/57.64041257.js"><link rel="prefetch" href="/assets/js/58.feb49a9c.js"><link rel="prefetch" href="/assets/js/59.dc8df387.js"><link rel="prefetch" href="/assets/js/6.d54c1117.js"><link rel="prefetch" href="/assets/js/60.631c04b3.js"><link rel="prefetch" href="/assets/js/61.32aea37e.js"><link rel="prefetch" href="/assets/js/62.5cfec479.js"><link rel="prefetch" href="/assets/js/63.1433dd8f.js"><link rel="prefetch" href="/assets/js/64.ad33ff3d.js"><link rel="prefetch" href="/assets/js/65.701a8222.js"><link rel="prefetch" href="/assets/js/66.24bd90de.js"><link rel="prefetch" href="/assets/js/67.d396f2ec.js"><link rel="prefetch" href="/assets/js/68.2afd7019.js"><link rel="prefetch" href="/assets/js/69.05781e5f.js"><link rel="prefetch" href="/assets/js/7.1b94b949.js"><link rel="prefetch" href="/assets/js/70.2cf85943.js"><link rel="prefetch" href="/assets/js/71.aab07104.js"><link rel="prefetch" href="/assets/js/72.1533ead8.js"><link rel="prefetch" href="/assets/js/73.4e5dc4da.js"><link rel="prefetch" href="/assets/js/74.e77dfcb1.js"><link rel="prefetch" href="/assets/js/75.e8e4c83e.js"><link rel="prefetch" href="/assets/js/76.ce341a40.js"><link rel="prefetch" href="/assets/js/77.c2342e89.js"><link rel="prefetch" href="/assets/js/78.a56458f9.js"><link rel="prefetch" href="/assets/js/79.6407212c.js"><link rel="prefetch" href="/assets/js/8.f8c818df.js"><link rel="prefetch" href="/assets/js/81.84c710c0.js"><link rel="prefetch" href="/assets/js/82.32cdc5bb.js"><link rel="prefetch" href="/assets/js/83.e08a0de0.js"><link rel="prefetch" href="/assets/js/84.59fefb9d.js"><link rel="prefetch" href="/assets/js/85.af63859c.js"><link rel="prefetch" href="/assets/js/86.513e36a1.js"><link rel="prefetch" href="/assets/js/87.c45c0b70.js"><link rel="prefetch" href="/assets/js/88.92b080af.js"><link rel="prefetch" href="/assets/js/89.ad5aec24.js"><link rel="prefetch" href="/assets/js/9.6d13d821.js"><link rel="prefetch" href="/assets/js/90.a5156631.js"><link rel="prefetch" href="/assets/js/91.fac5ac80.js"><link rel="prefetch" href="/assets/js/92.07aa1e42.js"><link rel="prefetch" href="/assets/js/93.c5f9a0d5.js"><link rel="prefetch" href="/assets/js/94.e05d5d7e.js"><link rel="prefetch" href="/assets/js/95.fea62791.js"><link rel="prefetch" href="/assets/js/96.449a8e88.js"><link rel="prefetch" href="/assets/js/97.94f2a5fd.js">
    <link rel="stylesheet" href="/assets/css/1.styles.b05fc641.css"><link rel="stylesheet" href="/assets/css/2.styles.a2bd3099.css"><link rel="stylesheet" href="/assets/css/styles.bb1fe17d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">大坚博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">客户端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/android/Activity生命周期.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/html/CSS的创建与表现.html" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/Spring.html" class="nav-link">Spring</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kotlin/Kotlin语法基础.html" class="nav-link">Kotlin</a></li><li class="dropdown-item"><!----> <a href="/java/Java平台.html" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/c/类型、运算符与表达式.html" class="nav-link">C</a></li><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">Python</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/设计模式基础.html" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/data-structure/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/network-and-security/" class="nav-link">网络与安全</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">系统与工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/mac/Homebrew.html" class="nav-link">Mac</a></li><li class="dropdown-item"><!----> <a href="/gradle/" class="nav-link">Gradle</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">多媒体</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/opencv/搭建OpenCV Android项目.html" class="nav-link">OpenCV</a></li><li class="dropdown-item"><!----> <a href="/ffmpeg/macOS上编译FFmpeg.html" class="nav-link">FFmpeg</a></li></ul></div></div><div class="nav-item"><a href="/about-me/" class="nav-link">关于我</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">客户端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/android/Activity生命周期.html" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/html/CSS的创建与表现.html" class="nav-link">HTML</a></li><li class="dropdown-item"><!----> <a href="/vue/" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/Spring.html" class="nav-link">Spring</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/mysql/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kotlin/Kotlin语法基础.html" class="nav-link">Kotlin</a></li><li class="dropdown-item"><!----> <a href="/java/Java平台.html" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/c/类型、运算符与表达式.html" class="nav-link">C</a></li><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">Python</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/设计模式基础.html" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/data-structure/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/network-and-security/" class="nav-link">网络与安全</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">系统与工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/mac/Homebrew.html" class="nav-link">Mac</a></li><li class="dropdown-item"><!----> <a href="/gradle/" class="nav-link">Gradle</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">多媒体</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/opencv/搭建OpenCV Android项目.html" class="nav-link">OpenCV</a></li><li class="dropdown-item"><!----> <a href="/ffmpeg/macOS上编译FFmpeg.html" class="nav-link">FFmpeg</a></li></ul></div></div><div class="nav-item"><a href="/about-me/" class="nav-link">关于我</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/opencv/搭建OpenCV Android项目.html" class="sidebar-link">搭建OpenCV Android项目</a></li><li><a href="/opencv/图像特效.html" class="active sidebar-link">图像特效</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#灰度处理" class="sidebar-link">灰度处理</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#颜色反转" class="sidebar-link">颜色反转</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#马赛克" class="sidebar-link">马赛克</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#毛玻璃" class="sidebar-link">毛玻璃</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#图片融合" class="sidebar-link">图片融合</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#边缘检测" class="sidebar-link">边缘检测</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#浮雕效果" class="sidebar-link">浮雕效果</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#颜色映射" class="sidebar-link">颜色映射</a></li><li class="sidebar-sub-header"><a href="/opencv/图像特效.html#油画特效" class="sidebar-link">油画特效</a></li></ul></li><li><a href="/opencv/直方图.html" class="sidebar-link">直方图</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="图像特效"><a href="#图像特效" aria-hidden="true" class="header-anchor">#</a> 图像特效</h1> <p></p><div class="table-of-contents"><ul><li><a href="#灰度处理">灰度处理</a></li><li><a href="#颜色反转">颜色反转</a></li><li><a href="#马赛克">马赛克</a></li><li><a href="#毛玻璃">毛玻璃</a></li><li><a href="#图片融合">图片融合</a></li><li><a href="#边缘检测">边缘检测</a></li><li><a href="#浮雕效果">浮雕效果</a></li><li><a href="#颜色映射">颜色映射</a></li><li><a href="#油画特效">油画特效</a></li></ul></div><p></p> <h2 id="灰度处理"><a href="#灰度处理" aria-hidden="true" class="header-anchor">#</a> 灰度处理</h2> <p>一般来说，彩图图像中的每个像素是由B、G、R三个颜色通道组成的，每个颜色通道占8位，于是每个像素占24位。而灰度图像中的每个像素都是灰度等级，只有一个颜色通道，占8位。</p> <p>图像灰度处理的原理是：将彩色图中每个像素的三个颜色通道，根据某一公式，算出灰度图中对应像素的灰度值。</p> <p>灰度处理的公式可以如下，即取三个颜色通道的均值。</p> <p>$$gray = {(B+G+R) \over 3}$$</p> <p>根据心理学得出如下的灰度处理公式。</p> <p>$$gray = {R * 0.299 + G * 0.587 + B * 0.114}$$</p> <p>OpenCV提供了便捷的API来实现图像的灰度处理。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> cv2
<span class="token comment"># 利用cv2.imread()载入图片时，参数二传入0表示载入为灰度图像</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'flower.jpg'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> cv2
<span class="token comment"># cv2载入图像的颜色空间默认为BGR</span>
img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'flower.jpg'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># 利用cv2.cvtColor进行颜色空间转换，cv2.COLOR_BGR2GRAY表示颜色空间从BGR转为Gray</span>
dst <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="颜色反转"><a href="#颜色反转" aria-hidden="true" class="header-anchor">#</a> 颜色反转</h2> <p>颜色反转就是将图像中的每个像素值的每个颜色通道值反转。</p> <p>一个颜色通道占8位，取值范围为0~255。所谓的颜色通道值反转就是用255减去原颜色通道值。</p> <p>灰度图的颜色反转的py代码实现如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        gray <span class="token operator">=</span> img<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span>
        img<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span> <span class="token operator">-</span> gray
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>彩色图的颜色反转的py代码实现如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token operator">=</span>  img<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span>
        dst<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">-</span>b<span class="token punctuation">,</span> <span class="token number">255</span><span class="token operator">-</span>g<span class="token punctuation">,</span> <span class="token number">255</span><span class="token operator">-</span>r<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="马赛克"><a href="#马赛克" aria-hidden="true" class="header-anchor">#</a> 马赛克</h2> <p>马赛克的原理是将指定区域所有点的像素值全部改为该区域某一个点（如左上角第一个点）的像素值。</p> <p><img src="/15401781738163/15401809006559.jpg" alt="马赛克原理"></p> <h2 id="毛玻璃"><a href="#毛玻璃" aria-hidden="true" class="header-anchor">#</a> 毛玻璃</h2> <p>毛玻璃的原理就是用当前点周围一定区域内任意一点的像素值来替换当前点像素值。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>
<span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 四周SCOPE区域内随机一点</span>
        index <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> SCOPE<span class="token punctuation">)</span>
        <span class="token comment"># 避免随机点越界</span>
        <span class="token keyword">while</span> m <span class="token operator">+</span> index <span class="token operator">&gt;=</span> height <span class="token operator">or</span> n <span class="token operator">+</span> index <span class="token operator">&gt;=</span> width<span class="token punctuation">:</span>
            index <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> SCOPE<span class="token punctuation">)</span>
        <span class="token comment"># 用随机点的像素值替换当前点</span>
        <span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token operator">=</span> img<span class="token punctuation">[</span>m<span class="token operator">+</span>index<span class="token punctuation">,</span> n<span class="token operator">+</span>index<span class="token punctuation">]</span>
        dst<span class="token punctuation">[</span>m<span class="token punctuation">,</span> n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="图片融合"><a href="#图片融合" aria-hidden="true" class="header-anchor">#</a> 图片融合</h2> <p>利用OpenCV的addWeighted函数来使两个图片加权和来实现图片融合。</p> <div class="language-c++ line-numbers-mode"><pre class="language-text"><code>void addWeighted(InputArray src1, double alpha, InputArray src2, double beta, double gamma, OutputArray
dst, int dtype=-1)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>src1：第一张图片的图像数据。</p></li> <li><p>alpha：第一张图片的权重。</p></li> <li><p>src2：第二张图片的图像数据。src2与src1有相同的大小和颜色通道数量。</p></li> <li><p>beta：第二张图片的权重。</p></li> <li><p>gamma：加权和后的像素值的偏移量。</p></li> <li><p>dst：两个图像加权和后的输出图像。</p></li> <li><p>dtype：dst的可选深度，默认为-1。当src1和src2具有相同的深度时，此参数可设置为-1，表示dst的深度等于src1的深度。</p></li></ul> <p>addWeighted函数的计算公式为：dst = src1 * alpha + src2 * beta + gamma。</p> <p>一般来说，alpha + beta = 1。</p> <p>addWeighted函数要求src1和src2具有相同的大小，一般需要在较大的图像（如src1）中设置感兴趣区域ROI，此ROI与较小的那个图像（如src2）尺寸一致，接着用该ROI范围内的图像数据与较小的那个图像的数据进行融合操作。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 在src1中设置ROI：左上角为src1的(0, 0)，高为src2高度，宽为src2宽度</span>
src1ROI <span class="token operator">=</span> src1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>src2Height<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span>src2Width<span class="token punctuation">]</span>
addWeighted<span class="token punctuation">(</span>src1ROI<span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">,</span> src2<span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> dst<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="边缘检测"><a href="#边缘检测" aria-hidden="true" class="header-anchor">#</a> 边缘检测</h2> <p>TODO</p> <h2 id="浮雕效果"><a href="#浮雕效果" aria-hidden="true" class="header-anchor">#</a> 浮雕效果</h2> <p>浮雕效果的实现方法很多，下面介绍一种常见的实现步骤：</p> <ol><li><p>原图灰度处理。</p></li> <li><p>利用如下的矩阵和灰度图进行卷积运算，再加上偏移量128，结果作为当前点的像素值。</p></li></ol> <p>$$
\left{
\begin{matrix}
1 &amp; 0 &amp; 0 \
0 &amp; 0 &amp; 0 \
0 &amp; 0 &amp; -1
\end{matrix}
\right}
$$</p> <p>灰度图与上面的矩阵进行卷积运算，实质上是当前点<code>(i,j)</code>的左上点<code>(i-1,j-1)</code>减去右下点<code>(i+1,j+1)</code>，再加上128，最后的结果值替换当前点的像素值。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        gray0 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gray<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        gray1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gray<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        out <span class="token operator">=</span> gray0 <span class="token operator">-</span> gray1 <span class="token operator">+</span> <span class="token number">128</span>
        <span class="token keyword">if</span> out <span class="token operator">&gt;</span> <span class="token number">255</span><span class="token punctuation">:</span>
            out <span class="token operator">=</span> <span class="token number">255</span>
        <span class="token keyword">if</span> out <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            out <span class="token operator">=</span> <span class="token number">0</span>
        dst<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> out
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="颜色映射"><a href="#颜色映射" aria-hidden="true" class="header-anchor">#</a> 颜色映射</h2> <p>颜色映射就是根据一个映射表或公式，将原图中的像素的颜色映射成新的颜色值。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span> <span class="token operator">=</span> img<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span>
        b <span class="token operator">=</span> b <span class="token operator">*</span> <span class="token number">1.5</span>
        g <span class="token operator">=</span> g <span class="token operator">*</span> <span class="token number">1.3</span>
        <span class="token keyword">if</span> b <span class="token operator">&gt;</span> <span class="token number">255</span><span class="token punctuation">:</span>
            b <span class="token operator">=</span> <span class="token number">255</span>
        <span class="token keyword">if</span> g <span class="token operator">&gt;</span> <span class="token number">255</span><span class="token punctuation">:</span>
            g <span class="token operator">=</span> <span class="token number">255</span>
        dst<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="油画特效"><a href="#油画特效" aria-hidden="true" class="header-anchor">#</a> 油画特效</h2> <p>油画特效的实现步骤：</p> <ol><li><p>对原图进行灰度处理，得到用于分析的灰度图。</p></li> <li><p>遍历原图的每个像素点<code>(i,j)</code>，分析灰度图对应点<code>(i,j)</code>周围区域内的像素值情况，将分析结果作为原图的像素点<code>(i,j)</code>的像素值。</p></li></ol> <p>像素点<code>(i,j)</code>的分析步骤：</p> <ol><li><p>确定分析区域：以当前点为中心的，大小为BLOCK_SIZE的矩形。</p></li> <li><p>将灰度全值<code>256</code>进行等级划分，如划分为8个32。</p></li> <li><p>在灰度图中，统计分析区域内各像素点对应的灰度等级。</p></li> <li><p>找出最高频的灰度等级的像素个数和灰度等级索引。</p></li> <li><p>在彩色图中，对分析区域内所有满足最高频灰度等级的像素点的各颜色通道值分别进行累加。</p></li> <li><p>分别求出上面各颜色通道均值（颜色通道值 / 最高频灰度等级的像素个数），并将其作为<code>(i,j)</code>的像素值的对应颜色通道值。</p></li></ol> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> cv2
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'../res/flower0.jpg'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
imgInfo <span class="token operator">=</span> img<span class="token punctuation">.</span>shape
height <span class="token operator">=</span> imgInfo<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
width <span class="token operator">=</span> imgInfo<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

ANALYSE_AREA_SIZE <span class="token operator">=</span> <span class="token number">8</span>
ANALYSE_AREA_SIZE_HALF <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>ANALYSE_AREA_SIZE <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
GRAY_LV_NUM <span class="token operator">=</span> <span class="token number">8</span>
GRAY_LV_EACH_VALUE <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">256</span> <span class="token operator">/</span> GRAY_LV_NUM<span class="token punctuation">)</span>

<span class="token comment"># 灰度处理</span>
gray <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>img<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2GRAY<span class="token punctuation">)</span>

dst <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>height<span class="token punctuation">,</span> width<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span>ANALYSE_AREA_SIZE_HALF<span class="token punctuation">,</span> height <span class="token operator">-</span> ANALYSE_AREA_SIZE_HALF<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span>ANALYSE_AREA_SIZE_HALF<span class="token punctuation">,</span> width <span class="token operator">-</span> ANALYSE_AREA_SIZE_HALF<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 灰度等级划分</span>
        grayLvCounter <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>GRAY_LV_NUM<span class="token punctuation">,</span> np<span class="token punctuation">.</span>uint32<span class="token punctuation">)</span>
        <span class="token comment"># 在灰度图中，统计分析区域内各像素点对应的灰度等级</span>
        <span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span>ANALYSE_AREA_SIZE_HALF<span class="token punctuation">,</span> ANALYSE_AREA_SIZE_HALF<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span>ANALYSE_AREA_SIZE_HALF<span class="token punctuation">,</span> ANALYSE_AREA_SIZE_HALF<span class="token punctuation">)</span><span class="token punctuation">:</span>
                grayValue <span class="token operator">=</span> gray<span class="token punctuation">[</span>i<span class="token operator">+</span>m<span class="token punctuation">,</span> j<span class="token operator">+</span>n<span class="token punctuation">]</span>
                grayIndex <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>grayValue <span class="token operator">/</span> GRAY_LV_EACH_VALUE<span class="token punctuation">)</span>
                grayLvCounter<span class="token punctuation">[</span>grayIndex<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token comment"># 找出最高频的灰度等级的像素个数和灰度等级索引</span>
        maxGrayLvCount <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>grayLvCounter<span class="token punctuation">)</span>
        maxGrayLvIndex <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>grayLvCounter<span class="token punctuation">)</span>
        <span class="token comment"># 在彩色图中，对分析区域内所有满足最高频灰度等级的像素点的各颜色通道值分别进行累加</span>
        bgrSum <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span>ANALYSE_AREA_SIZE_HALF<span class="token punctuation">,</span> ANALYSE_AREA_SIZE_HALF<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token operator">-</span>ANALYSE_AREA_SIZE_HALF<span class="token punctuation">,</span> ANALYSE_AREA_SIZE_HALF<span class="token punctuation">)</span><span class="token punctuation">:</span>
                grayIndex <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gray<span class="token punctuation">[</span>i<span class="token operator">+</span>m<span class="token punctuation">,</span> j<span class="token operator">+</span>n<span class="token punctuation">]</span> <span class="token operator">/</span> GRAY_LV_EACH_VALUE<span class="token punctuation">)</span>
                <span class="token keyword">if</span> grayIndex <span class="token operator">==</span> maxGrayLvIndex<span class="token punctuation">:</span>
                    bgrSum <span class="token operator">+=</span> img<span class="token punctuation">[</span>i<span class="token operator">+</span>m<span class="token punctuation">,</span> j<span class="token operator">+</span>n<span class="token punctuation">]</span>
        <span class="token comment"># 分别求出上面各颜色通道均值（颜色通道值 / 最高频灰度等级的像素个数），并将其作为当前点的像素值的对应颜色通道值</span>
        b <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bgrSum<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> maxGrayLvCount<span class="token punctuation">)</span>
        g <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bgrSum<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> maxGrayLvCount<span class="token punctuation">)</span>
        r <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bgrSum<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">/</span> maxGrayLvCount<span class="token punctuation">)</span>
        dst<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> g<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
        
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span> img<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span><span class="token string">'dst'</span><span class="token punctuation">,</span> dst<span class="token punctuation">)</span>
cv2<span class="token punctuation">.</span>waitKey<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/80.6554cb4c.js" defer></script><script src="/assets/js/app.bb1fe17d.js" defer></script>
  </body>
</html>
